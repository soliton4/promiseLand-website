//>>built
(function(h){"object"==typeof exports&&"object"==typeof module?h(require("../../lib/codemirror"),require("../../mode/sql/sql")):"function"==typeof define&&define.amd?define("codemirror4/addon/hint/sql-hint",["../../lib/codemirror","../../mode/sql/sql"],h):h(CodeMirror)})(function(h){function u(c){c=c.doc.modeOption;"sql"===c&&(c="text/x-sql");return h.resolveMode(c).keywords}function m(c,d,a,b){for(var e in a)if(a.hasOwnProperty(e)){Array.isArray(a)&&(e=a[e]);var f=d,g=e.substr(0,f.length);f.toUpperCase()===
g.toUpperCase()&&c.push(b(e))}}function v(c,d){var a=d.getCursor(),b=d.getTokenAt(a),e=b.string.substr(1),a=k(a.line,b.start),a=d.getTokenAt(a).string;n.hasOwnProperty(a)||(a=w(a,d));(a=n[a])&&m(c,e,a,function(a){return"."+a})}function x(c,d){if(c)for(var a=/[,;]/g,b=c.split(" "),e=0;e<b.length;e++)d(b[e]?b[e].replace(a,""):"")}function t(c){return c.line+c.ch/Math.pow(10,6)}function w(c,d){for(var a=d.doc,b=a.getValue(),e=c.toUpperCase(),f="",g="",q=[],h=k(0,0),m=k(d.lastLine(),d.getLineHandle(d.lastLine()).length),
l=b.indexOf(s.QUERY_DIV);-1!=l;)q.push(a.posFromIndex(l)),l=b.indexOf(s.QUERY_DIV,l+1);q.unshift(k(0,0));q.push(k(d.lastLine(),d.getLineHandle(d.lastLine()).text.length));for(var l=0,p=t(d.getCursor()),b=0;b<q.length;b++){var r=t(q[b]);if(p>l&&p<=r){h=k(Math.floor(l),+l.toString().split(".").pop());m=k(Math.floor(r),+r.toString().split(".").pop());break}l=r}a=a.getRange(h,m,!1);for(b=0;b<a.length&&!(x(a[b],function(a){var b=a.toUpperCase();b===e&&n.hasOwnProperty(f)&&(g=f);b!==s.ALIAS_KEYWORD&&(f=
a)}),g);b++);return g}var n,p,s={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},k=h.Pos;h.registerHelper("hint","sql",function(c,d){n=d&&d.tables||{};p=p||u(c);var a=c.getCursor(),b=c.getTokenAt(a),e=b.end,f=[],g=b.string.trim();if("."==g.charAt(0)){if(v(f,c),!f.length){for(;b.start&&"."==g.charAt(0);)b=c.getTokenAt(k(a.line,b.start-1)),g=b.string+g;m(f,g,n,function(a){return a})}}else m(f,g,p,function(a){return a.toUpperCase()}),m(f,g,n,function(a){return a});return{list:f,from:k(a.line,b.start),to:k(a.line,
e)}})});
//# sourceMappingURL=sql-hint.js.map