//>>built
(function(h){"object"==typeof exports&&"object"==typeof module?h(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("codemirror4/addon/comment/comment",["../../lib/codemirror"],h):h(CodeMirror)})(function(h){function s(a){a=a.search(p);return-1==a?0:a}var w={},p=/[^\s\u00a0]/,m=h.Pos;h.commands.toggleComment=function(a){for(var d=Infinity,c=a.listSelections(),b=null,k=c.length-1;0<=k;k--){var f=c[k].from(),g=c[k].to();f.line>=d||(g.line>=d&&(g=m(d,0)),d=f.line,null==b?a.uncomment(f,
g)?b="un":(a.lineComment(f,g),b="line"):"un"==b?a.uncomment(f,g):a.lineComment(f,g))}};h.defineExtension("lineComment",function(a,d,c){c||(c=w);var b=this,k=b.getModeAt(a),f=c.lineComment||k.lineComment;if(f){var g=b.getLine(a.line);if(null!=g){var n=Math.min(0!=d.ch||d.line==a.line?d.line+1:d.line,b.lastLine()+1),h=null==c.padding?" ":c.padding,l=c.commentBlankLines||a.line==d.line;b.operation(function(){if(c.indent)for(var d=g.slice(0,s(g)),e=a.line;e<n;++e){var k=b.getLine(e),q=d.length;if(l||
p.test(k))k.slice(0,q)!=d&&(q=s(k)),b.replaceRange(d+f+h,m(e,0),m(e,q))}else for(e=a.line;e<n;++e)(l||p.test(b.getLine(e)))&&b.replaceRange(f+h,m(e,0))})}}else if(c.blockCommentStart||k.blockCommentStart)c.fullLines=!0,b.blockComment(a,d,c)});h.defineExtension("blockComment",function(a,d,c){c||(c=w);var b=this,k=b.getModeAt(a),f=c.blockCommentStart||k.blockCommentStart,g=c.blockCommentEnd||k.blockCommentEnd;if(!f||!g)(c.lineComment||k.lineComment)&&!1!=c.fullLines&&b.lineComment(a,d,c);else{var n=
Math.min(d.line,b.lastLine());n!=a.line&&(0==d.ch&&p.test(b.getLine(n)))&&--n;var h=null==c.padding?" ":c.padding;a.line>n||b.operation(function(){if(!1!=c.fullLines){var l=p.test(b.getLine(n));b.replaceRange(h+g,m(n));b.replaceRange(f+h,m(a.line,0));var t=c.blockCommentLead||k.blockCommentLead;if(null!=t)for(var e=a.line+1;e<=n;++e)(e!=n||l)&&b.replaceRange(t+h,m(e,0))}else b.replaceRange(g,d),b.replaceRange(f,a)})}});h.defineExtension("uncomment",function(a,d,c){c||(c=w);var b=this,k=b.getModeAt(a),
f=Math.min(d.line,b.lastLine()),g=Math.min(a.line,f),h=c.lineComment||k.lineComment,s=[],l=null==c.padding?" ":c.padding,t;a:if(h){for(a=g;a<=f;++a){d=b.getLine(a);var e=d.indexOf(h);-1<e&&!/comment/.test(b.getTokenTypeAt(m(a,e+1)))&&(e=-1);if(-1==e&&(a!=f||a==g)&&p.test(d))break a;if(-1<e&&p.test(d.slice(0,e)))break a;s.push(d)}b.operation(function(){for(var a=g;a<=f;++a){var c=s[a-g],d=c.indexOf(h),e=d+h.length;0>d||(c.slice(e,e+l.length)==l&&(e+=l.length),t=!0,b.replaceRange("",m(a,d),m(a,e)))}});
if(t)return!0}var x=c.blockCommentStart||k.blockCommentStart,q=c.blockCommentEnd||k.blockCommentEnd;if(!x||!q)return!1;var y=c.blockCommentLead||k.blockCommentLead,z=b.getLine(g),u=f==g?z:b.getLine(f),v=z.indexOf(x),r=u.lastIndexOf(q);-1==r&&g!=f&&(u=b.getLine(--f),r=u.lastIndexOf(q));if(-1==v||-1==r||!/comment/.test(b.getTokenTypeAt(m(g,v+1)))||!/comment/.test(b.getTokenTypeAt(m(f,r+1))))return!1;b.operation(function(){b.replaceRange("",m(f,r-(l&&u.slice(r-l.length,r)==l?l.length:0)),m(f,r+q.length));
var a=v+x.length;l&&z.slice(a,a+l.length)==l&&(a+=l.length);b.replaceRange("",m(g,v),m(g,a));if(y)for(a=g+1;a<=f;++a){var c=b.getLine(a),d=c.indexOf(y);if(!(-1==d||p.test(c.slice(0,d)))){var e=d+y.length;l&&c.slice(e,e+l.length)==l&&(e+=l.length);b.replaceRange("",m(a,d),m(a,e))}}});return!0})});
//# sourceMappingURL=comment.js.map