//>>built
(function(d){"object"==typeof exports&&"object"==typeof module?d(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("codemirror4/addon/lint/lint",["../../lib/codemirror"],d):d(CodeMirror)})(function(d){function y(a,b){function c(a){if(!e.parentNode)return d.off(document,"mousemove",c);e.style.top=Math.max(0,a.clientY-e.offsetHeight-5)+"px";e.style.left=a.clientX+5+"px"}var e=document.createElement("div");e.className="CodeMirror-lint-tooltip";e.appendChild(b.cloneNode(!0));
document.body.appendChild(e);d.on(document,"mousemove",c);c(a);null!=e.style.opacity&&(e.style.opacity=1);return e}function z(a){a.parentNode&&(null==a.style.opacity&&a.parentNode&&a.parentNode.removeChild(a),a.style.opacity=0,setTimeout(function(){a.parentNode&&a.parentNode.removeChild(a)},600))}function r(a,b,c){function e(){d.off(c,"mouseout",e);f&&(z(f),f=null)}var f=y(a,b),g=setInterval(function(){if(f)for(var a=c;;a=a.parentNode){if(a==document.body)return;if(!a){e();break}}if(!f)return clearInterval(g)},
400);d.on(c,"mouseout",e)}function A(a,b,c){this.marked=[];this.options=b;this.timeout=null;this.hasGutter=c;this.onMouseOver=function(b){a:if(/\bCodeMirror-lint-mark-/.test((b.target||b.srcElement).className))for(var c=0;c<m.length;c+=2)for(var g=a.findMarksAt(a.coordsChar({left:b.clientX+m[c],top:b.clientY+m[c+1]},"client")),d=0;d<g.length;++d){var h=g[d].__annotation;if(h){c=b.target||b.srcElement;r(b,s(h),c);break a}}}}function t(a){var b=a.state.lint;b.hasGutter&&a.clearGutter(p);for(a=0;a<b.marked.length;++a)b.marked[a].clear();
b.marked.length=0}function B(a,b,c,e){var f=document.createElement("div"),g=f;f.className="CodeMirror-lint-marker-"+b;c&&(g=f.appendChild(document.createElement("div")),g.className="CodeMirror-lint-marker-multiple");if(!1!=e)d.on(g,"mouseover",function(b){r(b,a,g)});return f}function s(a){var b=a.severity;u.test(b)||(b="error");var c=document.createElement("div");c.className="CodeMirror-lint-message-"+b;c.appendChild(document.createTextNode(a.message));return c}function v(a){var b=a.state.lint.options;
b.async?b.getAnnotations(a,w,b):w(a,b.getAnnotations(a.getValue(),b.options))}function w(a,b){t(a);for(var c=a.state.lint,e=c.options,f=[],d=0;d<b.length;++d){var l=b[d],h=l.from.line;(f[h]||(f[h]=[])).push(l)}for(d=0;d<f.length;++d)if(l=f[d]){for(var h=null,m=c.hasGutter&&document.createDocumentFragment(),q=0;q<l.length;++q){var k=l[q],n=k.severity;u.test(n)||(n="error");"error"!=h&&(h=n);e.formatAnnotation&&(k=e.formatAnnotation(k));c.hasGutter&&m.appendChild(s(k));k.to&&c.marked.push(a.markText(k.from,
k.to,{className:"CodeMirror-lint-mark-"+n,__annotation:k}))}c.hasGutter&&a.setGutterMarker(d,p,B(m,h,1<l.length,c.options.tooltips))}if(e.onUpdateLinting)e.onUpdateLinting(b,f,a)}function x(a){var b=a.state.lint;clearTimeout(b.timeout);b.timeout=setTimeout(function(){v(a)},b.options.delay||500)}var p="CodeMirror-lint-markers",u=/^(?:error|warning)$/,m=[0,0,0,5,0,-5,5,0,-5,0];d.defineOption("lint",!1,function(a,b,c){c&&c!=d.Init&&(t(a),a.off("change",x),d.off(a.getWrapperElement(),"mouseover",a.state.lint.onMouseOver),
delete a.state.lint);if(b){var e=a.getOption("gutters");c=!1;for(var f=0;f<e.length;++f)e[f]==p&&(c=!0);e=a.state;if(b instanceof Function)b={getAnnotations:b};else{if(!b||!0===b)b={};b.getAnnotations||(b.getAnnotations=a.getHelper(d.Pos(0,0),"lint"));if(!b.getAnnotations)throw Error("Required option 'getAnnotations' missing (lint addon)");}c=e.lint=new A(a,b,c);a.on("change",x);if(!1!=c.options.tooltips)d.on(a.getWrapperElement(),"mouseover",c.onMouseOver);v(a)}})});
//# sourceMappingURL=lint.js.map