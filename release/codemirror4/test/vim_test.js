//>>built
define("codemirror4/test/vim_test",["dojo","dijit","dojox"],function(s,n,z){function D(b,c){for(var a=0;a<b.length;a++)c(b[a],a,b)}function d(b,c,a,d){var g={lineNumbers:!0,vimMode:!0,showCursorWhenSelecting:!0,value:E},f;for(f in a)a.hasOwnProperty(f)&&(g[f]=a[f]);return test("vim_"+b,function(){var a=document.getElementById("testground"),b=CodeMirror(a,g),d=CodeMirror.Vim.maybeInitVimState_(b),p={doKeys:function(a){return function(b){b instanceof Array&&(arguments=b);for(var c=0;c<arguments.length;c++)CodeMirror.Vim.handleKey(a,
arguments[c])}}(b),doInsertModeKeys:function(a){return function(b){function c(b){if("string"==typeof b)CodeMirror.commands[b](a);else b(a);return!0}b instanceof Array&&(arguments=b);for(var d=0;d<arguments.length;d++){var p=arguments[d];if(!0===CodeMirror.lookupKey(p,["vim-insert"],c)&&a.state.vim.insertMode&&"Esc"!=arguments[d]){var e=CodeMirror.Vim.getVimGlobalState_().macroModeState.lastInsertModeChanges;e&&e.changes.push(new CodeMirror.Vim.InsertModeKey(p))}}}}(b),doEx:function(a){return function(b){a.openDialog=
p.fakeOpenDialog(b);p.doKeys(":")}}(b),assertCursorAt:function(a){return function(b,c){var d;d=null==c&&"number"==typeof b.line?b:e(b,c);eqPos(d,a.getCursor())}}(b),fakeOpenDialog:function(a){return function(b,c){return c(a)}},fakeOpenNotification:function(a){return function(b){a(b)}},getRegisterController:function(){return CodeMirror.Vim.getRegisterController()}};CodeMirror.Vim.resetVimGlobalState_();var f=!1,h=b.openNotification;try{c(b,d,p),f=!0}finally{b.openNotification=h,!f||verbose?a.style.visibility=
"visible":a.removeChild(b.getWrapperElement())}},d)}function k(b,c,a,p,f){a=e(a[0],a[1]);p=e(p[0],p[1]);d(b,function(b,d,e){CodeMirror.Vim.resetVimGlobalState_();f&&(b.openDialog=e.fakeOpenDialog("word"));b.setCursor(p);e.doKeys.apply(null,c);e.assertCursorAt(a)},{value:F})}function g(b,c,a,p){d(b,function(b,d,e){p||(p={line:0,ch:0});b.setCursor(p);e.doKeys(c);e.assertCursorAt(a)})}function e(b,c){return{line:b,ch:c}}function u(b,c,a){return{line:b.line+c,ch:b.ch+a}}function f(b,c,a,p,e){return d(b,
function(b,d,f){d=c.search(a);var g=c.substring(0,d).split("\n").length-1;g&&(d=c.substring(0,d).split("\n").pop().length);b.setCursor(g,d);f.doKeys.apply(this,p.split(""));eq(e,b.getValue())},{value:c})}function l(b,c){d(b+"_pcre",function(a,b,d){a.setCursor(1,0);CodeMirror.Vim.setOption("pcre",!0);d.doEx(c.expr);eq(c.expectedValue,a.getValue())},c);var a=c.noPcreExpr?c.noPcreExpr:c.expr;d(b+"_nopcre",function(b,d,e){b.setCursor(1,0);CodeMirror.Vim.setOption("pcre",!1);e.doEx(a);eq(c.expectedValue,
b.getValue())},c)}function q(b,c,a,e,f,g){d(b,function(a,b,d){function h(){m=!0}b=a.openDialog;var k=CodeMirror.keyName,l,q,m=!0;a.openDialog=function(a,b,c){q=b};d.doKeys(":");a.openDialog=function(a,b,c){l=c.onKeyDown;m=!1};q(c);CodeMirror.keyName=function(a){return a.key};f=f.toUpperCase();for(var n=0;n<f.length;n++)is(!m),l({key:f.charAt(n)},"",h);try{eq(e,a.getValue()),d.assertCursorAt(g),is(m)}catch(r){throw r;}finally{CodeMirror.keyName=k,a.openDialog=b}},{value:a})}var E=" wOrd1 (#%\n word3] \naopop pop 0 1 2 3 4\n (a) [b] {c} \nint getchar(void) {\n  static char buf[BUFSIZ];\n  static char *bufp \x3d buf;\n  if (n \x3d\x3d 0) {  /* buffer is empty */\n    n \x3d read(0, buf, sizeof buf);\n    bufp \x3d buf;\n  }\n\n  return (--n \x3e\x3d 0) ? (unsigned char) *bufp++ : EOF;\n \n}\n",
h=function(){lineText=E.split("\n");for(var b=[],c=0;c<lineText.length;c++)b[c]={line:c,length:lineText[c].length,lineText:lineText[c],textStart:/^\s*/.exec(lineText[c])[0].length};return b}();s=e(h.length-1,h[h.length-1].length);var v=h[0],A=h[1];n=h[2];var w=h[3],x=h[4];z={line:v.line,ch:1};var t={line:v.line,ch:5},C={line:v.line,ch:t.ch+2},v={line:v.line,ch:t.ch+4},B={line:A.line,ch:1},y={line:A.line,ch:5},A={line:A.line,ch:1},m=[{line:n.line,ch:2},{line:n.line,ch:4},{line:n.line,ch:6},{line:n.line,
ch:8}],G=[{line:n.line,ch:10},{line:n.line,ch:12},{line:n.line,ch:14},{line:n.line,ch:16},{line:n.line,ch:18}],H={line:w.line,ch:1},I={line:w.line,ch:3},J={line:w.line,ch:5},K={line:w.line,ch:7},L={line:w.line,ch:9},w={line:w.line,ch:11},M={line:x.line,ch:1},N={line:x.line,ch:16},O={line:x.line,ch:14},x={line:x.line,ch:11};d("qq@q",function(b,c,a){b.setCursor(0,0);a.doKeys("q","q","l","l","q");a.assertCursorAt(0,2);a.doKeys("@","q");a.assertCursorAt(0,4)},{value:"            "});d("@@",function(b,
c,a){b.setCursor(0,0);a.doKeys("q","q","l","l","q");a.assertCursorAt(0,2);a.doKeys("@","q");a.assertCursorAt(0,4);a.doKeys("@","@");a.assertCursorAt(0,6)},{value:"            "});var F="word\n(word)\n{word\nword.\n\nword search\n}word\nword\nword\n";k("jumplist_H",["H","\x3cC-o\x3e"],[5,2],[5,2]);k("jumplist_M",["M","\x3cC-o\x3e"],[2,2],[2,2]);k("jumplist_L",["L","\x3cC-o\x3e"],[2,2],[2,2]);k("jumplist_[[",["[","[","\x3cC-o\x3e"],[5,2],[5,2]);k("jumplist_]]",["]","]","\x3cC-o\x3e"],[2,2],[2,2]);k("jumplist_G",
["G","\x3cC-o\x3e"],[5,2],[5,2]);k("jumplist_gg",["g","g","\x3cC-o\x3e"],[5,2],[5,2]);k("jumplist_%",["%","\x3cC-o\x3e"],[1,5],[1,5]);k("jumplist_{",["{","\x3cC-o\x3e"],[1,5],[1,5]);k("jumplist_}",["}","\x3cC-o\x3e"],[1,5],[1,5]);k("jumplist_'","m a h ' a h \x3cC-i\x3e".split(" "),[1,0],[1,5]);k("jumplist_`","m a h ` a h \x3cC-i\x3e".split(" "),[1,5],[1,5]);k("jumplist_*_cachedCursor",["*","\x3cC-o\x3e"],[1,3],[1,3]);k("jumplist_#_cachedCursor",["#","\x3cC-o\x3e"],[1,3],[1,3]);k("jumplist_n",["#",
"n","\x3cC-o\x3e"],[1,1],[2,3]);k("jumplist_N",["#","N","\x3cC-o\x3e"],[1,1],[2,3]);k("jumplist_repeat_\x3cc-o\x3e",["*","*","*","3","\x3cC-o\x3e"],[2,3],[2,3]);k("jumplist_repeat_\x3cc-i\x3e","* * * 3 \x3cC-o\x3e 2 \x3cC-i\x3e".split(" "),[5,0],[2,3]);k("jumplist_repeated_motion",["3","*","\x3cC-o\x3e"],[2,3],[2,3]);k("jumplist_/",["/","\x3cC-o\x3e"],[2,3],[2,3],"dialog");k("jumplist_?",["?","\x3cC-o\x3e"],[2,3],[2,3],"dialog");k("jumplist_skip_delted_mark\x3cc-o\x3e","* n n k d k \x3cC-o\x3e \x3cC-o\x3e \x3cC-o\x3e".split(" "),
[0,2],[0,2]);k("jumplist_skip_delted_mark\x3cc-i\x3e","* n n k d k \x3cC-o\x3e \x3cC-i\x3e \x3cC-i\x3e".split(" "),[1,0],[0,2]);g("|","|",e(0,0),e(0,4));g("|_repeat",["3","|"],e(0,2),e(0,4));g("h","h",e(0,0),z);g("h_repeat",["3","h"],u(t,0,-3),t);g("l","l",e(0,1));g("l_repeat",["2","l"],e(0,2));g("j","j",u(t,1,0),t);g("j_repeat",["2","j"],u(t,2,0),t);g("j_repeat_clip",["1000","j"],s);g("k","k",u(y,-1,0),y);g("k_repeat",["2","k"],e(0,4),e(2,4));g("k_repeat_clip",["1000","k"],e(0,4),e(2,4));g("w","w",
z);g("w_multiple_newlines_no_space","w",e(12,2),e(11,2));g("w_multiple_newlines_with_space","w",e(14,0),e(12,51));g("w_repeat",["2","w"],C);g("w_wrap",["w"],B,C);g("w_endOfDocument","w",s,s);g("w_start_to_end",["1000","w"],s,e(0,0));g("W","W",z);g("W_repeat",["2","W"],A,z);g("e","e",t);g("e_repeat",["2","e"],v);g("e_wrap","e",y,v);g("e_endOfDocument","e",s,s);g("e_start_to_end",["1000","e"],s,e(0,0));g("b","b",B,y);g("b_repeat",["2","b"],C,y);g("b_wrap","b",C,B);g("b_startOfDocument","b",e(0,0),e(0,
0));g("b_end_to_start",["1000","b"],e(0,0),s);g("ge",["g","e"],v,y);g("ge_repeat",["2","g","e"],t,B);g("ge_wrap",["g","e"],v,B);g("ge_startOfDocument",["g","e"],e(0,0),e(0,0));g("ge_end_to_start",["1000","g","e"],e(0,0),s);g("gg",["g","g"],e(h[0].line,h[0].textStart),e(3,1));g("gg_repeat",["3","g","g"],e(h[2].line,h[2].textStart));g("G","G",e(h[h.length-1].line,h[h.length-1].textStart),e(3,1));g("G_repeat",["3","G"],e(h[2].line,h[2].textStart));g("0","0",e(0,0),e(0,8));g("^","^",e(0,h[0].textStart),
e(0,8));g("+","+",e(1,h[1].textStart),e(0,8));g("-","-",e(0,h[0].textStart),e(1,4));g("_",["6","_"],e(5,h[5].textStart),e(0,8));g("$","$",e(0,h[0].length-1),e(0,1));g("$_repeat",["2","$"],e(1,h[1].length-1),e(0,3));g("f",["f","p"],m[0],e(n.line,0));g("f_repeat",["2","f","p"],m[2],m[0]);g("f_num",["f","2"],G[2],e(n.line,0));g("t",["t","p"],u(m[0],0,-1),e(n.line,0));g("t_repeat",["2","t","p"],u(m[2],0,-1),m[0]);g("F",["F","p"],m[0],m[1]);g("F_repeat",["2","F","p"],m[0],m[2]);g("T",["T","p"],u(m[0],
0,1),m[1]);g("T_repeat",["2","T","p"],u(m[0],0,1),m[2]);g("%_parens",["%"],I,H);g("%_squares",["%"],K,J);g("%_braces",["%"],w,L);g("%_seek_outside",["%"],N,M);g("%_seek_inside",["%"],x,O);d("%_seek_skip",function(b,c,a){b.setCursor(0,0);a.doKeys(["%"]);a.assertCursorAt(0,9)},{value:'01234"("()'});d("%_skip_string",function(b,c,a){b.setCursor(0,0);a.doKeys(["%"]);a.assertCursorAt(0,4);b.setCursor(0,2);a.doKeys(["%"]);a.assertCursorAt(0,0)},{value:'(")")'});")";d("%_skip_comment",function(b,c,a){b.setCursor(0,
0);a.doKeys(["%"]);a.assertCursorAt(0,6);b.setCursor(0,3);a.doKeys(["%"]);a.assertCursorAt(0,0)},{value:"(/*)*/)"});d("Changing lines after Eol operation",function(b,c,a){b.setCursor(0,0);a.doKeys(["$"]);a.doKeys(["j"]);a.assertCursorAt({line:1,ch:h[1].length-1});a.doKeys(["j"]);a.assertCursorAt({line:2,ch:h[2].length-1});a.doKeys(["h"]);a.doKeys(["j"]);a.assertCursorAt({line:3,ch:h[3].length-1});a.doKeys(["j"]);a.doKeys(["j"]);a.assertCursorAt({line:5,ch:h[2].length-2})});d("gj_gk_clipping",function(b,
c,a){b.setCursor(0,1);a.doKeys("g","j","g","j");a.assertCursorAt(2,1);a.doKeys("g","k","g","k");a.assertCursorAt(0,1)},{value:"line 1\n\nline 2"});d("j_k_and_gj_gk",function(b,c,a){b.setSize(120);b.setCursor(0,0);a.doKeys("$");a.doKeys("g","k");c=b.getCursor();eq(c.line,0);is(176>c.ch,"gk didn't move cursor back (1)");a.doKeys("g","j");a.assertCursorAt(0,176);a.doKeys("j");a.doKeys("3","g","k");c=b.getCursor();eq(c.line,1);is(176>c.ch,"gk didn't move cursor back (2)");a.doKeys("g","j","2","g","j");
a.doKeys("k");a.assertCursorAt(0,176)},{lineWrapping:!0,value:"This line is intentially long to test movement of gj and gk over wrapped lines. I will start on the end of this line, then make a step up and back to set the origin for j and k.\nThis line is supposed to be even longer than the previous. I will jump here and make another wiggle with gj and gk, before I jump back to the line above. Both wiggles should not change my cursor's target character but both j/k and gj/gk change each other's reference position."});
d("gj_gk",function(b,c,a){phantom||(b.setSize(120),b.setCursor(0,4),a.doKeys("g","j"),a.doKeys("10","g","k"),a.assertCursorAt(0,4),a.doKeys("g","j"),c={line:0,ch:2*(b.getCursor().ch-4)+4},a.doKeys("g","j"),a.assertCursorAt(c),b.setCursor(0,0),a.doKeys("h"),a.doKeys("100","g","j"),c=b.getCursor(),is(0!=c,"gj should not be on wrapped line 0"),a=b.charCoords(e(0,0)),b=b.charCoords(c),is(a.left==b.left,"gj should end up on column 0"))},{lineNumbers:!1,lineWrapping:!0,value:"Thislineisintentiallylongtotestmovementofgjandgkoverwrappedlines."});
d("}",function(b,c,a){b.setCursor(0,0);a.doKeys("}");a.assertCursorAt(1,0);b.setCursor(0,0);a.doKeys("2","}");a.assertCursorAt(4,0);b.setCursor(0,0);a.doKeys("6","}");a.assertCursorAt(5,0)},{value:"a\n\nb\nc\n\nd"});d("{",function(b,c,a){b.setCursor(5,0);a.doKeys("{");a.assertCursorAt(4,0);b.setCursor(5,0);a.doKeys("2","{");a.assertCursorAt(1,0);b.setCursor(5,0);a.doKeys("6","{");a.assertCursorAt(0,0)},{value:"a\n\nb\nc\n\nd"});d("dl",function(b,c,a){c=e(0,0);b.setCursor(c);a.doKeys("d","l");eq("word1 ",
b.getValue());a=a.getRegisterController().getRegister();eq(" ",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1 "});d("dl_eol",function(b,c,a){b.setCursor(0,6);a.doKeys("d","l");eq(" word1",b.getValue());b=a.getRegisterController().getRegister();eq(" ",b.toString());is(!b.linewise);a.assertCursorAt(0,5)},{value:" word1 "});d("dl_repeat",function(b,c,a){c=e(0,0);b.setCursor(c);a.doKeys("2","d","l");eq("ord1 ",b.getValue());a=a.getRegisterController().getRegister();eq(" w",a.toString());
is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1 "});d("dh",function(b,c,a){c=e(0,3);b.setCursor(c);a.doKeys("d","h");eq(" wrd1 ",b.getValue());a=a.getRegisterController().getRegister();eq("o",a.toString());is(!a.linewise);eqPos(u(c,0,-1),b.getCursor())},{value:" word1 "});d("dj",function(b,c,a){c=e(0,3);b.setCursor(c);a.doKeys("d","j");eq(" word3",b.getValue());b=a.getRegisterController().getRegister();eq(" word1\nword2\n",b.toString());is(b.linewise);a.assertCursorAt(0,1)},{value:" word1\nword2\n word3"});
d("dj_end_of_document",function(b,c,a){c=e(0,3);b.setCursor(c);a.doKeys("d","j");eq(" word1 ",b.getValue());b=a.getRegisterController().getRegister();eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,3)},{value:" word1 "});d("dk",function(b,c,a){c=e(1,3);b.setCursor(c);a.doKeys("d","k");eq(" word3",b.getValue());b=a.getRegisterController().getRegister();eq(" word1\nword2\n",b.toString());is(b.linewise);a.assertCursorAt(0,1)},{value:" word1\nword2\n word3"});d("dk_start_of_document",function(b,
c,a){c=e(0,3);b.setCursor(c);a.doKeys("d","k");eq(" word1 ",b.getValue());b=a.getRegisterController().getRegister();eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,3)},{value:" word1 "});d("dw_space",function(b,c,a){c=e(0,0);b.setCursor(c);a.doKeys("d","w");eq("word1 ",b.getValue());a=a.getRegisterController().getRegister();eq(" ",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1 "});d("dw_word",function(b,c,a){c=e(0,1);b.setCursor(c);a.doKeys("d","w");eq(" word2",b.getValue());
a=a.getRegisterController().getRegister();eq("word1 ",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1 word2"});d("dw_only_word",function(b,c,a){b.setCursor(0,1);a.doKeys("d","w");eq(" ",b.getValue());b=a.getRegisterController().getRegister();eq("word1 ",b.toString());is(!b.linewise);a.assertCursorAt(0,0)},{value:" word1 "});d("dw_eol",function(b,c,a){b.setCursor(0,1);a.doKeys("d","w");eq(" \nword2",b.getValue());b=a.getRegisterController().getRegister();eq("word1",b.toString());
is(!b.linewise);a.assertCursorAt(0,0)},{value:" word1\nword2"});d("dw_eol_with_multiple_newlines",function(b,c,a){b.setCursor(0,1);a.doKeys("d","w");eq(" \n\nword2",b.getValue());b=a.getRegisterController().getRegister();eq("word1",b.toString());is(!b.linewise);a.assertCursorAt(0,0)},{value:" word1\n\nword2"});d("dw_empty_line_followed_by_whitespace",function(b,c,a){b.setCursor(0,0);a.doKeys("d","w");eq("  \nword",b.getValue())},{value:"\n  \nword"});d("dw_empty_line_followed_by_word",function(b,
c,a){b.setCursor(0,0);a.doKeys("d","w");eq("word",b.getValue())},{value:"\nword"});d("dw_empty_line_followed_by_empty_line",function(b,c,a){b.setCursor(0,0);a.doKeys("d","w");eq("\n",b.getValue())},{value:"\n\n"});d("dw_whitespace_followed_by_whitespace",function(b,c,a){b.setCursor(0,0);a.doKeys("d","w");eq("\n   \n",b.getValue())},{value:"  \n   \n"});d("dw_whitespace_followed_by_empty_line",function(b,c,a){b.setCursor(0,0);a.doKeys("d","w");eq("\n\n",b.getValue())},{value:"  \n\n"});d("dw_word_whitespace_word",
function(b,c,a){b.setCursor(0,0);a.doKeys("d","w");eq("\n   \nword2",b.getValue())},{value:"word1\n   \nword2"});d("dw_end_of_document",function(b,c,a){b.setCursor(1,2);a.doKeys("d","w");eq("\nab",b.getValue())},{value:"\nabc"});d("dw_repeat",function(b,c,a){b.setCursor(0,1);a.doKeys("d","2","w");eq(" ",b.getValue());b=a.getRegisterController().getRegister();eq("word1\nword2",b.toString());is(!b.linewise);a.assertCursorAt(0,0)},{value:" word1\nword2"});d("de_word_start_and_empty_lines",function(b,
c,a){b.setCursor(0,0);a.doKeys("d","e");eq("\n\n",b.getValue())},{value:"word\n\n"});d("de_word_end_and_empty_lines",function(b,c,a){b.setCursor(0,3);a.doKeys("d","e");eq("wor",b.getValue())},{value:"word\n\n\n"});d("de_whitespace_and_empty_lines",function(b,c,a){b.setCursor(0,0);a.doKeys("d","e");eq("",b.getValue())},{value:"   \n\n\n"});d("de_end_of_document",function(b,c,a){b.setCursor(1,2);a.doKeys("d","e");eq("\nab",b.getValue())},{value:"\nabc"});d("db_empty_lines",function(b,c,a){b.setCursor(2,
0);a.doKeys("d","b");eq("\n\n",b.getValue())},{value:"\n\n\n"});d("db_word_start_and_empty_lines",function(b,c,a){b.setCursor(2,0);a.doKeys("d","b");eq("\nword",b.getValue())},{value:"\n\nword"});d("db_word_end_and_empty_lines",function(b,c,a){b.setCursor(2,3);a.doKeys("d","b");eq("\n\nd",b.getValue())},{value:"\n\nword"});d("db_whitespace_and_empty_lines",function(b,c,a){b.setCursor(2,0);a.doKeys("d","b");eq("",b.getValue())},{value:"\n   \n"});d("db_start_of_document",function(b,c,a){b.setCursor(0,
0);a.doKeys("d","b");eq("abc\n",b.getValue())},{value:"abc\n"});d("dge_empty_lines",function(b,c,a){b.setCursor(1,0);a.doKeys("d","g","e");eq("\n",b.getValue())},{value:"\n\n"});d("dge_word_and_empty_lines",function(b,c,a){b.setCursor(1,0);a.doKeys("d","g","e");eq("wor\n",b.getValue())},{value:"word\n\n"});d("dge_whitespace_and_empty_lines",function(b,c,a){b.setCursor(2,0);a.doKeys("d","g","e");eq("",b.getValue())},{value:"\n  \n"});d("dge_start_of_document",function(b,c,a){b.setCursor(0,0);a.doKeys("d",
"g","e");eq("bc\n",b.getValue())},{value:"abc\n"});d("d_inclusive",function(b,c,a){c=e(0,1);b.setCursor(c);a.doKeys("d","e");eq("  ",b.getValue());a=a.getRegisterController().getRegister();eq("word1",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1 "});d("d_reverse",function(b,c,a){b.setCursor(1,0);a.doKeys("d","b");eq(" word2 ",b.getValue());b=a.getRegisterController().getRegister();eq("word1\n",b.toString());is(!b.linewise);a.assertCursorAt(0,1)},{value:" word1\nword2 "});d("dd",
function(b,c,a){b.setCursor(0,3);c=b.getRange({line:0,ch:0},{line:1,ch:0});var d=b.lineCount()-1;a.doKeys("d","d");eq(d,b.lineCount());b=a.getRegisterController().getRegister();eq(c,b.toString());is(b.linewise);a.assertCursorAt(0,h[1].textStart)});d("dd_prefix_repeat",function(b,c,a){b.setCursor(0,3);c=b.getRange({line:0,ch:0},{line:2,ch:0});var d=b.lineCount()-2;a.doKeys("2","d","d");eq(d,b.lineCount());b=a.getRegisterController().getRegister();eq(c,b.toString());is(b.linewise);a.assertCursorAt(0,
h[2].textStart)});d("dd_motion_repeat",function(b,c,a){b.setCursor(0,3);c=b.getRange({line:0,ch:0},{line:2,ch:0});var d=b.lineCount()-2;a.doKeys("d","2","d");eq(d,b.lineCount());b=a.getRegisterController().getRegister();eq(c,b.toString());is(b.linewise);a.assertCursorAt(0,h[2].textStart)});d("dd_multiply_repeat",function(b,c,a){b.setCursor(0,3);c=b.getRange({line:0,ch:0},{line:6,ch:0});var d=b.lineCount()-6;a.doKeys("2","d","3","d");eq(d,b.lineCount());b=a.getRegisterController().getRegister();eq(c,
b.toString());is(b.linewise);a.assertCursorAt(0,h[6].textStart)});d("dd_lastline",function(b,c,a){b.setCursor(b.lineCount(),0);c=b.lineCount()-1;a.doKeys("d","d");eq(c,b.lineCount());a.assertCursorAt(b.lineCount()-1,0)});d("yw_repeat",function(b,c,a){c=e(0,1);b.setCursor(c);a.doKeys("y","2","w");eq(" word1\nword2",b.getValue());a=a.getRegisterController().getRegister();eq("word1\nword2",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1\nword2"});d("yy_multiply_repeat",function(b,
c,a){c=e(0,3);b.setCursor(c);var d=b.getRange({line:0,ch:0},{line:6,ch:0}),f=b.lineCount();a.doKeys("2","y","3","y");eq(f,b.lineCount());a=a.getRegisterController().getRegister();eq(d,a.toString());is(a.linewise);eqPos(c,b.getCursor())});d("cw",function(b,c,a){b.setCursor(0,0);a.doKeys("c","2","w");eq(" word3",b.getValue());a.assertCursorAt(0,0)},{value:"word1 word2 word3"});d("cw_repeat",function(b,c,a){c=e(0,1);b.setCursor(c);a.doKeys("c","2","w");eq(" ",b.getValue());a=a.getRegisterController().getRegister();
eq("word1\nword2",a.toString());is(!a.linewise);eqPos(c,b.getCursor());eq("vim-insert",b.getOption("keyMap"))},{value:" word1\nword2"});d("cc_multiply_repeat",function(b,c,a){b.setCursor(0,3);c=b.getRange({line:0,ch:0},{line:6,ch:0});var d=b.lineCount()-5;a.doKeys("2","c","3","c");eq(d,b.lineCount());a=a.getRegisterController().getRegister();eq(c,a.toString());is(a.linewise);eq("vim-insert",b.getOption("keyMap"))});d("cc_append",function(b,c,a){c=b.lineCount();b.setCursor(b.lastLine(),0);a.doKeys("c",
"c");eq(c,b.lineCount())});d("g~w_repeat",function(b,c,a){c=e(0,1);b.setCursor(c);a.doKeys("g","~","2","w");eq(" WORD1\nWORD2",b.getValue());a=a.getRegisterController().getRegister();eq("",a.toString());is(!a.linewise);eqPos(c,b.getCursor())},{value:" word1\nword2"});d("g~g~",function(b,c,a){c=e(0,3);b.setCursor(c);b.lineCount();var d=b.getValue().toUpperCase();a.doKeys("2","g","~","3","g","~");eq(d,b.getValue());a=a.getRegisterController().getRegister();eq("",a.toString());is(!a.linewise);eqPos(c,
b.getCursor())},{value:" word1\nword2\nword3\nword4\nword5\nword6"});d("\x3e{motion}",function(b,c,a){b.setCursor(1,3);b.lineCount();a.doKeys("\x3e","k");eq("   word1\n  word2\nword3 ",b.getValue());b=a.getRegisterController().getRegister();eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,3)},{value:" word1\nword2\nword3 ",indentUnit:2});d("\x3e\x3e",function(b,c,a){b.setCursor(0,3);b.lineCount();a.doKeys("2","\x3e","\x3e");eq("   word1\n  word2\nword3 ",b.getValue());b=a.getRegisterController().getRegister();
eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,3)},{value:" word1\nword2\nword3 ",indentUnit:2});d("\x3c{motion}",function(b,c,a){b.setCursor(1,3);b.lineCount();a.doKeys("\x3c","k");eq(" word1\nword2\nword3 ",b.getValue());b=a.getRegisterController().getRegister();eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,1)},{value:"   word1\n  word2\nword3 ",indentUnit:2});d("\x3c\x3c",function(b,c,a){b.setCursor(0,3);b.lineCount();a.doKeys("2","\x3c","\x3c");eq(" word1\nword2\nword3 ",b.getValue());
b=a.getRegisterController().getRegister();eq("",b.toString());is(!b.linewise);a.assertCursorAt(0,1)},{value:"   word1\n  word2\nword3 ",indentUnit:2});f("diw_mid_spc","foo \tbAr\t baz",/A/,"diw","foo \t\t baz");f("daw_mid_spc","foo \tbAr\t baz",/A/,"daw","foo \tbaz");f("diw_mid_punct","foo \tbAr.\t baz",/A/,"diw","foo \t.\t baz");f("daw_mid_punct","foo \tbAr.\t baz",/A/,"daw","foo.\t baz");f("diw_mid_punct2","foo \t,bAr.\t baz",/A/,"diw","foo \t,.\t baz");f("daw_mid_punct2","foo \t,bAr.\t baz",/A/,
"daw","foo \t,.\t baz");f("diw_start_spc","bAr \tbaz",/A/,"diw"," \tbaz");f("daw_start_spc","bAr \tbaz",/A/,"daw","baz");f("diw_start_punct","bAr. \tbaz",/A/,"diw",". \tbaz");f("daw_start_punct","bAr. \tbaz",/A/,"daw",". \tbaz");f("diw_end_spc","foo \tbAr",/A/,"diw","foo \t");f("daw_end_spc","foo \tbAr",/A/,"daw","foo");f("diw_end_punct","foo \tbAr.",/A/,"diw","foo \t.");f("daw_end_punct","foo \tbAr.",/A/,"daw","foo.");f("diW_mid_spc","foo \tbAr\t baz",/A/,"diW","foo \t\t baz");f("daW_mid_spc","foo \tbAr\t baz",
/A/,"daW","foo \tbaz");f("diW_mid_punct","foo \tbAr.\t baz",/A/,"diW","foo \t\t baz");f("daW_mid_punct","foo \tbAr.\t baz",/A/,"daW","foo \tbaz");f("diW_mid_punct2","foo \t,bAr.\t baz",/A/,"diW","foo \t\t baz");f("daW_mid_punct2","foo \t,bAr.\t baz",/A/,"daW","foo \tbaz");f("diW_start_spc","bAr\t baz",/A/,"diW","\t baz");f("daW_start_spc","bAr\t baz",/A/,"daW","baz");f("diW_start_punct","bAr.\t baz",/A/,"diW","\t baz");f("daW_start_punct","bAr.\t baz",/A/,"daW","baz");f("diW_end_spc","foo \tbAr",
/A/,"diW","foo \t");f("daW_end_spc","foo \tbAr",/A/,"daW","foo");f("diW_end_punct","foo \tbAr.",/A/,"diW","foo \t");f("daW_end_punct","foo \tbAr.",/A/,"daW","foo");f("di(_open_spc","foo (bAr) baz",/\(/,"di(","foo () baz");f("di)_open_spc","foo (bAr) baz",/\(/,"di)","foo () baz");f("dib_open_spc","foo (bAr) baz",/\(/,"dib","foo () baz");f("da(_open_spc","foo (bAr) baz",/\(/,"da(","foo  baz");f("da)_open_spc","foo (bAr) baz",/\(/,"da)","foo  baz");f("di(_middle_spc","foo (bAr) baz",/A/,"di(","foo () baz");
f("di)_middle_spc","foo (bAr) baz",/A/,"di)","foo () baz");f("da(_middle_spc","foo (bAr) baz",/A/,"da(","foo  baz");f("da)_middle_spc","foo (bAr) baz",/A/,"da)","foo  baz");f("di(_close_spc","foo (bAr) baz",/\)/,"di(","foo () baz");f("di)_close_spc","foo (bAr) baz",/\)/,"di)","foo () baz");f("da(_close_spc","foo (bAr) baz",/\)/,"da(","foo  baz");f("da)_close_spc","foo (bAr) baz",/\)/,"da)","foo  baz");f("dab_on_(_should_delete_around_()block","o( in(abc) )",/\(a/,"dab","o( in )");f("daB_on_{_should_delete_around_{}block",
"o{ in{abc} }",/{a/,"daB","o{ in }");f("diB_on_{_should_delete_inner_{}block","o{ in{abc} }",/{a/,"diB","o{ in{} }");f("da{_on_{_should_delete_inner_block","o{ in{abc} }",/{a/,"da{","o{ in }");f("di[_on_(_should_not_delete","foo (bAr) baz",/\(/,"di[","foo (bAr) baz");f("di[_on_)_should_not_delete","foo (bAr) baz",/\)/,"di[","foo (bAr) baz");f("da[_on_(_should_not_delete","foo (bAr) baz",/\(/,"da[","foo (bAr) baz");f("da[_on_)_should_not_delete","foo (bAr) baz",/\)/,"da[","foo (bAr) baz");g("di(_outside_should_stay",
["d","i","("],{line:0,ch:0},{line:0,ch:0});f("di{_middle_spc","a{\n\tbar\n}b",/r/,"di{","a{}b");f("di}_middle_spc","a{\n\tbar\n}b",/r/,"di}","a{}b");f("da{_middle_spc","a{\n\tbar\n}b",/r/,"da{","ab");f("da}_middle_spc","a{\n\tbar\n}b",/r/,"da}","ab");f("daB_middle_spc","a{\n\tbar\n}b",/r/,"daB","ab");f("di{_middle_spc","a{\n\tbar\n\t}b",/r/,"di{","a{}b");f("di}_middle_spc","a{\n\tbar\n\t}b",/r/,"di}","a{}b");f("da{_middle_spc","a{\n\tbar\n\t}b",/r/,"da{","ab");f("da}_middle_spc","a{\n\tbar\n\t}b",
/r/,"da}","ab");f("di[_middle_spc","a\t[\n\tbar\n]b",/r/,"di[","a\t[]b");f("di]_middle_spc","a\t[\n\tbar\n]b",/r/,"di]","a\t[]b");f("da[_middle_spc","a\t[\n\tbar\n]b",/r/,"da[","a\tb");f("da]_middle_spc","a\t[\n\tbar\n]b",/r/,"da]","a\tb");d("D",function(b,c,a){b.setCursor(0,3);a.doKeys("D");eq(" wo\nword2\n word3",b.getValue());b=a.getRegisterController().getRegister();eq("rd1",b.toString());is(!b.linewise);a.assertCursorAt(0,2)},{value:" word1\nword2\n word3"});d("C",function(b,c,a){c=e(0,3);b.setCursor(c);
a.doKeys("C");eq(" wo\nword2\n word3",b.getValue());a=a.getRegisterController().getRegister();eq("rd1",a.toString());is(!a.linewise);eqPos(c,b.getCursor());eq("vim-insert",b.getOption("keyMap"))},{value:" word1\nword2\n word3"});d("Y",function(b,c,a){c=e(0,3);b.setCursor(c);a.doKeys("Y");eq(" word1\nword2\n word3",b.getValue());b=a.getRegisterController().getRegister();eq("rd1",b.toString());is(!b.linewise);a.assertCursorAt(0,3)},{value:" word1\nword2\n word3"});d("~",function(b,c,a){a.doKeys("3",
"~");eq("ABCdefg",b.getValue());a.assertCursorAt(0,3)},{value:"abcdefg"});d("ctrl-a",function(b,c,a){b.setCursor(0,0);a.doKeys("\x3cC-a\x3e");eq("-9",b.getValue());a.assertCursorAt(0,1);a.doKeys("2","\x3cC-a\x3e");eq("-7",b.getValue())},{value:"-10"});d("ctrl-x",function(b,c,a){b.setCursor(0,0);a.doKeys("\x3cC-x\x3e");eq("-1",b.getValue());a.assertCursorAt(0,1);a.doKeys("2","\x3cC-x\x3e");eq("-3",b.getValue())},{value:"0"});d("\x3cC-x\x3e/\x3cC-a\x3e search forward",function(b,c,a){D(["\x3cC-x\x3e",
"\x3cC-a\x3e"],function(c){b.setCursor(0,0);a.doKeys(c);a.assertCursorAt(0,5);a.doKeys("l");a.doKeys(c);a.assertCursorAt(0,10);b.setCursor(0,11);a.doKeys(c);a.assertCursorAt(0,11)})},{value:"__jmp1 jmp2 jmp"});d("a",function(b,c,a){b.setCursor(0,1);a.doKeys("a");a.assertCursorAt(0,2);eq("vim-insert",b.getOption("keyMap"))});d("a_eol",function(b,c,a){b.setCursor(0,h[0].length-1);a.doKeys("a");a.assertCursorAt(0,h[0].length);eq("vim-insert",b.getOption("keyMap"))});d("i",function(b,c,a){b.setCursor(0,
1);a.doKeys("i");a.assertCursorAt(0,1);eq("vim-insert",b.getOption("keyMap"))});d("i_repeat",function(b,c,a){a.doKeys("3","i");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");eq("testtesttest",b.getValue());a.assertCursorAt(0,11)},{value:""});d("i_repeat_delete",function(b,c,a){b.setCursor(0,4);a.doKeys("2","i");b.replaceRange("z",b.getCursor());a.doInsertModeKeys("Backspace","Backspace","Esc");eq("abe",b.getValue());a.assertCursorAt(0,1)},{value:"abcde"});d("A",function(b,c,a){a.doKeys("A");
a.assertCursorAt(0,h[0].length);eq("vim-insert",b.getOption("keyMap"))});d("I",function(b,c,a){b.setCursor(0,4);a.doKeys("I");a.assertCursorAt(0,h[0].textStart);eq("vim-insert",b.getOption("keyMap"))});d("I_repeat",function(b,c,a){b.setCursor(0,1);a.doKeys("3","I");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");eq("testtesttestblah",b.getValue());a.assertCursorAt(0,11)},{value:"blah"});d("o",function(b,c,a){b.setCursor(0,4);a.doKeys("o");eq("word1\n\nword2",b.getValue());a.assertCursorAt(1,
0);eq("vim-insert",b.getOption("keyMap"))},{value:"word1\nword2"});d("o_repeat",function(b,c,a){b.setCursor(0,0);a.doKeys("3","o");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");eq("\ntest\ntest\ntest",b.getValue());a.assertCursorAt(3,3)},{value:""});d("O",function(b,c,a){b.setCursor(0,4);a.doKeys("O");eq("\nword1\nword2",b.getValue());a.assertCursorAt(0,0);eq("vim-insert",b.getOption("keyMap"))},{value:"word1\nword2"});d("J",function(b,c,a){b.setCursor(0,4);a.doKeys("J");eq("word1  word2\nword3\n word4",
b.getValue());a.assertCursorAt(0,6)},{value:"word1 \n    word2\nword3\n word4"});d("J_repeat",function(b,c,a){b.setCursor(0,4);a.doKeys("3","J");eq("word1  word2 word3\n word4",b.getValue());a.assertCursorAt(0,12)},{value:"word1 \n    word2\nword3\n word4"});d("p",function(b,c,a){b.setCursor(0,1);a.getRegisterController().pushText('"',"yank","abc\ndef",!1);a.doKeys("p");eq("__abc\ndef_",b.getValue());a.assertCursorAt(1,2)},{value:"___"});d("p_register",function(b,c,a){b.setCursor(0,1);a.getRegisterController().getRegister("a").setText("abc\ndef",
!1);a.doKeys('"',"a","p");eq("__abc\ndef_",b.getValue());a.assertCursorAt(1,2)},{value:"___"});d("p_wrong_register",function(b,c,a){b.setCursor(0,1);a.getRegisterController().getRegister("a").setText("abc\ndef",!1);a.doKeys("p");eq("___",b.getValue());a.assertCursorAt(0,1)},{value:"___"});d("p_line",function(b,c,a){b.setCursor(0,1);a.getRegisterController().pushText('"',"yank","  a\nd\n",!0);a.doKeys("2","p");eq("___\n  a\nd\n  a\nd",b.getValue());a.assertCursorAt(1,2)},{value:"___"});d("p_lastline",
function(b,c,a){b.setCursor(0,1);a.getRegisterController().pushText('"',"yank","  a\nd",!0);a.doKeys("2","p");eq("___\n  a\nd\n  a\nd",b.getValue());a.assertCursorAt(1,2)},{value:"___"});d("]p_first_indent_is_smaller",function(b,c,a){a.getRegisterController().pushText('"',"yank","  abc\n    def\n",!0);a.doKeys("]","p");eq("  ___\n  abc\n    def",b.getValue())},{value:"  ___"});d("]p_first_indent_is_larger",function(b,c,a){a.getRegisterController().pushText('"',"yank","    abc\n  def\n",!0);a.doKeys("]",
"p");eq("  ___\n  abc\ndef",b.getValue())},{value:"  ___"});d("]p_with_tab_indents",function(b,c,a){a.getRegisterController().pushText('"',"yank","\t\tabc\n\t\t\tdef\n",!0);a.doKeys("]","p");eq("\t___\n\tabc\n\t\tdef",b.getValue())},{value:"\t___",indentWithTabs:!0});d("]p_with_spaces_translated_to_tabs",function(b,c,a){a.getRegisterController().pushText('"',"yank","  abc\n    def\n",!0);a.doKeys("]","p");eq("\t___\n\tabc\n\t\tdef",b.getValue())},{value:"\t___",indentWithTabs:!0,tabSize:2});d("[p",
function(b,c,a){a.getRegisterController().pushText('"',"yank","  abc\n    def\n",!0);a.doKeys("[","p");eq("  abc\n    def\n  ___",b.getValue())},{value:"  ___"});d("P",function(b,c,a){b.setCursor(0,1);a.getRegisterController().pushText('"',"yank","abc\ndef",!1);a.doKeys("P");eq("_abc\ndef__",b.getValue());a.assertCursorAt(1,3)},{value:"___"});d("P_line",function(b,c,a){b.setCursor(0,1);a.getRegisterController().pushText('"',"yank","  a\nd\n",!0);a.doKeys("2","P");eq("  a\nd\n  a\nd\n___",b.getValue());
a.assertCursorAt(0,2)},{value:"___"});d("r",function(b,c,a){b.setCursor(0,1);a.doKeys("3","r","u");eq("wuuuet\nanother",b.getValue(),"3r failed");a.assertCursorAt(0,3);b.setCursor(0,4);a.doKeys("v","j","h","r","\x3cSpace\x3e");eq("wuuu  \n    her",b.getValue(),"Replacing selection by space-characters failed")},{value:"wordet\nanother"});d("R",function(b,c,a){b.setCursor(0,1);a.doKeys("R");a.assertCursorAt(0,1);eq("vim-replace",b.getOption("keyMap"));is(b.state.overwrite,"Setting overwrite state failed")});
d("mark",function(b,c,a){b.setCursor(2,2);a.doKeys("m","t");b.setCursor(0,0);a.doKeys("`","t");a.assertCursorAt(2,2);b.setCursor(2,0);b.replaceRange("   h",b.getCursor());b.setCursor(0,0);a.doKeys("'","t");a.assertCursorAt(2,3)});d("jumpToMark_next",function(b,c,a){b.setCursor(2,2);a.doKeys("m","t");b.setCursor(0,0);a.doKeys("]","`");a.assertCursorAt(2,2);b.setCursor(0,0);a.doKeys("]","'");a.assertCursorAt(2,0)});d("jumpToMark_next_repeat",function(b,c,a){b.setCursor(2,2);a.doKeys("m","a");b.setCursor(3,
2);a.doKeys("m","b");b.setCursor(4,2);a.doKeys("m","c");b.setCursor(0,0);a.doKeys("2","]","`");a.assertCursorAt(3,2);b.setCursor(0,0);a.doKeys("2","]","'");a.assertCursorAt(3,1)});d("jumpToMark_next_sameline",function(b,c,a){b.setCursor(2,0);a.doKeys("m","a");b.setCursor(2,4);a.doKeys("m","b");b.setCursor(2,2);a.doKeys("]","`");a.assertCursorAt(2,4)});d("jumpToMark_next_onlyprev",function(b,c,a){b.setCursor(2,0);a.doKeys("m","a");b.setCursor(4,0);a.doKeys("]","`");a.assertCursorAt(4,0)});d("jumpToMark_next_nomark",
function(b,c,a){b.setCursor(2,2);a.doKeys("]","`");a.assertCursorAt(2,2);a.doKeys("]","'");a.assertCursorAt(2,0)});d("jumpToMark_next_linewise_over",function(b,c,a){b.setCursor(2,2);a.doKeys("m","a");b.setCursor(3,4);a.doKeys("m","b");b.setCursor(2,1);a.doKeys("]","'");a.assertCursorAt(3,1)});d("jumpToMark_next_action",function(b,c,a){b.setCursor(2,2);a.doKeys("m","t");b.setCursor(0,0);a.doKeys("d","]","`");a.assertCursorAt(0,0);b=b.getLine(0);eq(b,"pop pop 0 1 2 3 4","Deleting while jumping to the next mark failed.")});
d("jumpToMark_next_line_action",function(b,c,a){b.setCursor(2,2);a.doKeys("m","t");b.setCursor(0,0);a.doKeys("d","]","'");a.assertCursorAt(0,1);b=b.getLine(0);eq(b," (a) [b] {c} ","Deleting while jumping to the next mark line failed.")});d("jumpToMark_prev",function(b,c,a){b.setCursor(2,2);a.doKeys("m","t");b.setCursor(4,0);a.doKeys("[","`");a.assertCursorAt(2,2);b.setCursor(4,0);a.doKeys("[","'");a.assertCursorAt(2,0)});d("jumpToMark_prev_repeat",function(b,c,a){b.setCursor(2,2);a.doKeys("m","a");
b.setCursor(3,2);a.doKeys("m","b");b.setCursor(4,2);a.doKeys("m","c");b.setCursor(5,0);a.doKeys("2","[","`");a.assertCursorAt(3,2);b.setCursor(5,0);a.doKeys("2","[","'");a.assertCursorAt(3,1)});d("jumpToMark_prev_sameline",function(b,c,a){b.setCursor(2,0);a.doKeys("m","a");b.setCursor(2,4);a.doKeys("m","b");b.setCursor(2,2);a.doKeys("[","`");a.assertCursorAt(2,0)});d("jumpToMark_prev_onlynext",function(b,c,a){b.setCursor(4,4);a.doKeys("m","a");b.setCursor(2,0);a.doKeys("[","`");a.assertCursorAt(2,
0)});d("jumpToMark_prev_nomark",function(b,c,a){b.setCursor(2,2);a.doKeys("[","`");a.assertCursorAt(2,2);a.doKeys("[","'");a.assertCursorAt(2,0)});d("jumpToMark_prev_linewise_over",function(b,c,a){b.setCursor(2,2);a.doKeys("m","a");b.setCursor(3,4);a.doKeys("m","b");b.setCursor(3,6);a.doKeys("[","'");a.assertCursorAt(2,0)});d("delmark_single",function(b,c,a){b.setCursor(1,2);a.doKeys("m","t");a.doEx("delmarks t");b.setCursor(0,0);a.doKeys("`","t");a.assertCursorAt(0,0)});d("delmark_range",function(b,
c,a){b.setCursor(1,2);a.doKeys("m","a");b.setCursor(2,2);a.doKeys("m","b");b.setCursor(3,2);a.doKeys("m","c");b.setCursor(4,2);a.doKeys("m","d");b.setCursor(5,2);a.doKeys("m","e");a.doEx("delmarks b-d");b.setCursor(0,0);a.doKeys("`","a");a.assertCursorAt(1,2);a.doKeys("`","b");a.assertCursorAt(1,2);a.doKeys("`","c");a.assertCursorAt(1,2);a.doKeys("`","d");a.assertCursorAt(1,2);a.doKeys("`","e");a.assertCursorAt(5,2)});d("delmark_multi",function(b,c,a){b.setCursor(1,2);a.doKeys("m","a");b.setCursor(2,
2);a.doKeys("m","b");b.setCursor(3,2);a.doKeys("m","c");b.setCursor(4,2);a.doKeys("m","d");b.setCursor(5,2);a.doKeys("m","e");a.doEx("delmarks bcd");b.setCursor(0,0);a.doKeys("`","a");a.assertCursorAt(1,2);a.doKeys("`","b");a.assertCursorAt(1,2);a.doKeys("`","c");a.assertCursorAt(1,2);a.doKeys("`","d");a.assertCursorAt(1,2);a.doKeys("`","e");a.assertCursorAt(5,2)});d("delmark_multi_space",function(b,c,a){b.setCursor(1,2);a.doKeys("m","a");b.setCursor(2,2);a.doKeys("m","b");b.setCursor(3,2);a.doKeys("m",
"c");b.setCursor(4,2);a.doKeys("m","d");b.setCursor(5,2);a.doKeys("m","e");a.doEx("delmarks b c d");b.setCursor(0,0);a.doKeys("`","a");a.assertCursorAt(1,2);a.doKeys("`","b");a.assertCursorAt(1,2);a.doKeys("`","c");a.assertCursorAt(1,2);a.doKeys("`","d");a.assertCursorAt(1,2);a.doKeys("`","e");a.assertCursorAt(5,2)});d("delmark_all",function(b,c,a){b.setCursor(1,2);a.doKeys("m","a");b.setCursor(2,2);a.doKeys("m","b");b.setCursor(3,2);a.doKeys("m","c");b.setCursor(4,2);a.doKeys("m","d");b.setCursor(5,
2);a.doKeys("m","e");a.doEx("delmarks a b-de");b.setCursor(0,0);a.doKeys("`","a");a.assertCursorAt(0,0);a.doKeys("`","b");a.assertCursorAt(0,0);a.doKeys("`","c");a.assertCursorAt(0,0);a.doKeys("`","d");a.assertCursorAt(0,0);a.doKeys("`","e");a.assertCursorAt(0,0)});d("visual",function(b,c,a){a.doKeys("l","v","l","l");a.assertCursorAt(0,3);eqPos(e(0,1),b.getCursor("anchor"));a.doKeys("d");eq("15",b.getValue())},{value:"12345"});d("visual_line",function(b,c,a){a.doKeys("l","V","l","j","j","d");eq(" 4\n 5",
b.getValue())},{value:" 1\n 2\n 3\n 4\n 5"});d("visual_marks",function(b,c,a){a.doKeys("l","v","l","l","j","j","v");b.setCursor(2,1);a.doKeys("'","\x3c");a.assertCursorAt(0,1);a.doKeys("'","\x3e");a.assertCursorAt(2,0)});d("visual_join",function(b,c,a){a.doKeys("l","V","l","j","j","J");eq(" 1 2 3\n 4\n 5",b.getValue())},{value:" 1\n 2\n 3\n 4\n 5"});d("visual_blank",function(b,c,a){a.doKeys("v","k");eq(c.visualMode,!0)},{value:"\n"});d("reselect_visual",function(b,c,a){a.doKeys("l","v","l","l","y",
"g","v");a.assertCursorAt(0,3);eqPos(e(0,1),b.getCursor("anchor"));a.doKeys("d");eq("15",b.getValue())},{value:"12345"});d("reselect_visual_line",function(b,c,a){a.doKeys("l","V","l","j","j","V","g","v","d");eq(" 4\n 5",b.getValue())},{value:" 1\n 2\n 3\n 4\n 5"});d("s_normal",function(b,c,a){b.setCursor(0,1);a.doKeys("s");a.doInsertModeKeys("Esc");a.assertCursorAt(0,0);eq("ac",b.getValue())},{value:"abc"});d("s_visual",function(b,c,a){b.setCursor(0,1);a.doKeys("v","s");a.doInsertModeKeys("Esc");
a.assertCursorAt(0,0);eq("ac",b.getValue())},{value:"abc"});d("o_visual",function(b,c,a){b.setCursor(0,0);a.doKeys("v","l","l","l","o");a.assertCursorAt(0,0);a.doKeys("v","v","j","j","j","o");a.assertCursorAt(0,0);a.doKeys("o");a.doKeys("l","l");a.assertCursorAt(3,2);a.doKeys("d");eq("p",b.getValue())},{value:"abcd\nefgh\nijkl\nmnop"});d("uppercase/lowercase_visual",function(b,c,a){b.setCursor(0,0);a.doKeys("v","l","l");a.doKeys("U");a.assertCursorAt(0,0);a.doKeys("v","l","l");a.doKeys("u");a.assertCursorAt(0,
0);a.doKeys("l","l","l",".");a.assertCursorAt(0,3);b.setCursor(0,0);a.doKeys("q","a","v","j","U","q");a.assertCursorAt(0,0);a.doKeys("j","@","a");a.assertCursorAt(1,0);b.setCursor(3,0);a.doKeys("V","U","j",".");eq("ABCDEF\nGHIJKL\nMnopq\nSHORT LINE\nLONG LINE OF TEXT",b.getValue())},{value:"abcdef\nghijkl\nmnopq\nshort line\nlong line of text"});d("S_normal",function(b,c,a){b.setCursor(0,1);a.doKeys("j","S");a.doInsertModeKeys("Esc");a.assertCursorAt(1,0);eq("aa\n\ncc",b.getValue())},{value:"aa\nbb\ncc"});
d("S_visual",function(b,c,a){b.setCursor(0,1);a.doKeys("v","j","S");a.doInsertModeKeys("Esc");a.assertCursorAt(0,0);eq("\ncc",b.getValue())},{value:"aa\nbb\ncc"});d("/ and n/N",function(b,c,a){b.openDialog=a.fakeOpenDialog("match");a.doKeys("/");a.assertCursorAt(0,11);a.doKeys("n");a.assertCursorAt(1,6);a.doKeys("N");a.assertCursorAt(0,11);b.setCursor(0,0);a.doKeys("2","/");a.assertCursorAt(1,6)},{value:"match nope match \n nope Match"});d("/_case",function(b,c,a){b.openDialog=a.fakeOpenDialog("Match");
a.doKeys("/");a.assertCursorAt(1,6)},{value:"match nope match \n nope Match"});d("/_2_pcre",function(b,c,a){CodeMirror.Vim.setOption("pcre",!0);b.openDialog=a.fakeOpenDialog("(word){2}");a.doKeys("/");a.assertCursorAt(1,9);a.doKeys("n");a.assertCursorAt(2,1)},{value:"word\n another wordword\n wordwordword\n"});d("/_2_nopcre",function(b,c,a){CodeMirror.Vim.setOption("pcre",!1);b.openDialog=a.fakeOpenDialog("\\(word\\)\\{2}");a.doKeys("/");a.assertCursorAt(1,9);a.doKeys("n");a.assertCursorAt(2,1)},
{value:"word\n another wordword\n wordwordword\n"});d("/_nongreedy",function(b,c,a){b.openDialog=a.fakeOpenDialog("aa");a.doKeys("/");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(1,3);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa aa \n a aa"});d("?_nongreedy",function(b,c,a){b.openDialog=a.fakeOpenDialog("aa");a.doKeys("?");a.assertCursorAt(1,3);a.doKeys("n");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa aa \n a aa"});d("/_greedy",function(b,c,a){b.openDialog=a.fakeOpenDialog("a+");
a.doKeys("/");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(1,1);a.doKeys("n");a.assertCursorAt(1,3);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa aa \n a aa"});d("?_greedy",function(b,c,a){b.openDialog=a.fakeOpenDialog("a+");a.doKeys("?");a.assertCursorAt(1,3);a.doKeys("n");a.assertCursorAt(1,1);a.doKeys("n");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa aa \n a aa"});d("/_greedy_0_or_more",function(b,c,a){b.openDialog=a.fakeOpenDialog("a*");a.doKeys("/");a.assertCursorAt(0,
3);a.doKeys("n");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(0,5);a.doKeys("n");a.assertCursorAt(1,0);a.doKeys("n");a.assertCursorAt(1,1);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa  aa\n aa"});d("?_greedy_0_or_more",function(b,c,a){b.openDialog=a.fakeOpenDialog("a*");a.doKeys("?");a.assertCursorAt(1,1);a.doKeys("n");a.assertCursorAt(1,0);a.doKeys("n");a.assertCursorAt(0,5);a.doKeys("n");a.assertCursorAt(0,4);a.doKeys("n");a.assertCursorAt(0,3);a.doKeys("n");a.assertCursorAt(0,0)},{value:"aaa  aa\n aa"});
d("? and n/N",function(b,c,a){b.openDialog=a.fakeOpenDialog("match");a.doKeys("?");a.assertCursorAt(1,6);a.doKeys("n");a.assertCursorAt(0,11);a.doKeys("N");a.assertCursorAt(1,6);b.setCursor(0,0);a.doKeys("2","?");a.assertCursorAt(0,11)},{value:"match nope match \n nope Match"});d("*",function(b,c,a){b.setCursor(0,9);a.doKeys("*");a.assertCursorAt(0,22);b.setCursor(0,9);a.doKeys("2","*");a.assertCursorAt(1,8)},{value:"nomatch match nomatch match \nnomatch Match"});d("*_no_word",function(b,c,a){b.setCursor(0,
0);a.doKeys("*");a.assertCursorAt(0,0)},{value:" \n match \n"});d("*_symbol",function(b,c,a){b.setCursor(0,0);a.doKeys("*");a.assertCursorAt(1,0)},{value:" /}\n/} match \n"});d("#",function(b,c,a){b.setCursor(0,9);a.doKeys("#");a.assertCursorAt(1,8);b.setCursor(0,9);a.doKeys("2","#");a.assertCursorAt(0,22)},{value:"nomatch match nomatch match \nnomatch Match"});d("*_seek",function(b,c,a){b.setCursor(0,3);a.doKeys("*");a.assertCursorAt(0,22)},{value:"    :\x3d  match nomatch match \nnomatch Match"});
d("#",function(b,c,a){b.setCursor(0,3);a.doKeys("#");a.assertCursorAt(1,8)},{value:"    :\x3d  match nomatch match \nnomatch Match"});d("g*",function(b,c,a){b.setCursor(0,8);a.doKeys("g","*");a.assertCursorAt(0,18);b.setCursor(0,8);a.doKeys("3","g","*");a.assertCursorAt(1,8)},{value:"matches match alsoMatch\nmatchme matching"});d("g#",function(b,c,a){b.setCursor(0,8);a.doKeys("g","#");a.assertCursorAt(0,0);b.setCursor(0,8);a.doKeys("3","g","#");a.assertCursorAt(1,0)},{value:"matches match alsoMatch\nmatchme matching"});
d("macro_insert",function(b,c,a){b.setCursor(0,0);a.doKeys("q","a","0","i");b.replaceRange("foo",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("q","@","a");eq("foofoo",b.getValue())},{value:""});d("macro_space",function(b,c,a){b.setCursor(0,0);a.doKeys("\x3cSpace\x3e","\x3cSpace\x3e");a.assertCursorAt(0,2);a.doKeys("q","a","\x3cSpace\x3e","\x3cSpace\x3e","q");a.assertCursorAt(0,4);a.doKeys("@","a");a.assertCursorAt(0,6);a.doKeys("@","a");a.assertCursorAt(0,8)},{value:"one line of text."});d("macro_t_search",
function(b,c,a){b.setCursor(0,0);a.doKeys("q","a","t","e","q");a.assertCursorAt(0,1);a.doKeys("l","@","a");a.assertCursorAt(0,6);a.doKeys("l",";");a.assertCursorAt(0,12)},{value:"one line of text."});d("macro_f_search",function(b,c,a){b.setCursor(0,0);a.doKeys("q","b","f","e","q");a.assertCursorAt(0,2);a.doKeys("@","b");a.assertCursorAt(0,7);a.doKeys(";");a.assertCursorAt(0,13)},{value:"one line of text."});d("macro_slash_search",function(b,c,a){b.setCursor(0,0);a.doKeys("q","c");b.openDialog=a.fakeOpenDialog("e");
a.doKeys("/","q");a.assertCursorAt(0,2);a.doKeys("@","c");a.assertCursorAt(0,7);a.doKeys("n");a.assertCursorAt(0,13)},{value:"one line of text."});d("macro_multislash_search",function(b,c,a){b.setCursor(0,0);a.doKeys("q","d");b.openDialog=a.fakeOpenDialog("e");a.doKeys("/");b.openDialog=a.fakeOpenDialog("t");a.doKeys("/","q");a.assertCursorAt(0,12);a.doKeys("@","d");a.assertCursorAt(0,15)},{value:"one line of text to rule them all."});d("macro_parens",function(b,c,a){b.setCursor(0,0);a.doKeys("q",
"z","i");b.replaceRange("(",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("e","a");b.replaceRange(")",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("q");a.doKeys("w","@","z");a.doKeys("w","@","z");eq("(see) (spot) (run)",b.getValue())},{value:"see spot run"});d("macro_overwrite",function(b,c,a){b.setCursor(0,0);a.doKeys("q","z","0","i");b.replaceRange("I ",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("q");a.doKeys("e");a.doKeys("q","z","a");b.replaceRange(".",b.getCursor());a.doInsertModeKeys("Esc");
a.doKeys("q");a.doKeys("e","@","z");a.doKeys("e","@","z");eq("I see. spot. run.",b.getValue())},{value:"see spot run"});d("macro_search_f",function(b,c,a){b.setCursor(0,0);a.doKeys("q","a","f"," ");a.assertCursorAt(0,3);a.doKeys("q","0");a.assertCursorAt(0,0);a.doKeys("@","a");a.assertCursorAt(0,3)},{value:"The quick brown fox jumped over the lazy dog."});d("macro_search_2f",function(b,c,a){b.setCursor(0,0);a.doKeys("q","a","2","f"," ");a.assertCursorAt(0,9);a.doKeys("q","0");a.assertCursorAt(0,0);
a.doKeys("@","a");a.assertCursorAt(0,9)},{value:"The quick brown fox jumped over the lazy dog."});d("yank_register",function(b,c,a){b.setCursor(0,0);a.doKeys('"',"a","y","y");a.doKeys("j",'"',"b","y","y");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/a\s+foo/.test(a));is(/b\s+bar/.test(a))});a.doKeys(":")},{value:"foo\nbar"});d("yank_append_line_to_line_register",function(b,c,a){b.setCursor(0,0);a.doKeys('"',"a","y","y");a.doKeys("j",'"',"A",
"y","y");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/a\s+foo\nbar/.test(a));is(/"\s+foo\nbar/.test(a))});a.doKeys(":")},{value:"foo\nbar"});d("yank_append_word_to_word_register",function(b,c,a){b.setCursor(0,0);a.doKeys('"',"a","y","w");a.doKeys("j",'"',"A","y","w");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/a\s+foobar/.test(a));is(/"\s+foobar/.test(a))});a.doKeys(":")},{value:"foo\nbar"});
d("yank_append_line_to_word_register",function(b,c,a){b.setCursor(0,0);a.doKeys('"',"a","y","w");a.doKeys("j",'"',"A","y","y");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/a\s+foo\nbar/.test(a));is(/"\s+foo\nbar/.test(a))});a.doKeys(":")},{value:"foo\nbar"});d("yank_append_word_to_line_register",function(b,c,a){b.setCursor(0,0);a.doKeys('"',"a","y","y");a.doKeys("j",'"',"A","y","w");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=
a.fakeOpenNotification(function(a){is(/a\s+foo\nbar/.test(a));is(/"\s+foo\nbar/.test(a))});a.doKeys(":")},{value:"foo\nbar"});d("macro_register",function(b,c,a){b.setCursor(0,0);a.doKeys("q","a","i");b.replaceRange("gangnam",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("q");a.doKeys("q","b","o");b.replaceRange("style",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys("q");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/a\s+i/.test(a));is(/b\s+o/.test(a))});
a.doKeys(":")},{value:""});d("._register",function(b,c,a){b.setCursor(0,0);a.doKeys("i");b.replaceRange("foo",b.getCursor());a.doInsertModeKeys("Esc");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/\.\s+foo/.test(a))});a.doKeys(":")},{value:""});d(":_register",function(b,c,a){a.doEx("bar");b.openDialog=a.fakeOpenDialog("registers");b.openNotification=a.fakeOpenNotification(function(a){is(/:\s+bar/.test(a))});a.doKeys(":")},{value:""});d(".",function(b,
c,a){b.setCursor(0,0);a.doKeys("2","d","w");a.doKeys(".");eq("5 6",b.getValue())},{value:"1 2 3 4 5 6"});d("._repeat",function(b,c,a){b.setCursor(0,0);a.doKeys("2","d","w");a.doKeys("3",".");eq("6",b.getValue())},{value:"1 2 3 4 5 6"});d("._insert",function(b,c,a){a.doKeys("i");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");a.doKeys(".");eq("testestt",b.getValue());a.assertCursorAt(0,6)},{value:""});d("._insert_repeat",function(b,c,a){a.doKeys("i");b.replaceRange("test",b.getCursor());
b.setCursor(0,4);a.doInsertModeKeys("Esc");a.doKeys("2",".");eq("testesttestt",b.getValue());a.assertCursorAt(0,10)},{value:""});d("._repeat_insert",function(b,c,a){a.doKeys("3","i");b.replaceRange("te",b.getCursor());b.setCursor(0,2);a.doInsertModeKeys("Esc");a.doKeys(".");eq("tetettetetee",b.getValue());a.assertCursorAt(0,10)},{value:""});d("._insert_o",function(b,c,a){a.doKeys("o");b.replaceRange("z",b.getCursor());b.setCursor(1,1);a.doInsertModeKeys("Esc");a.doKeys(".");eq("\nz\nz",b.getValue());
a.assertCursorAt(2,0)},{value:""});d("._insert_o_repeat",function(b,c,a){a.doKeys("o");b.replaceRange("z",b.getCursor());a.doInsertModeKeys("Esc");b.setCursor(1,0);a.doKeys("2",".");eq("\nz\nz\nz",b.getValue());a.assertCursorAt(3,0)},{value:""});d("._insert_o_indent",function(b,c,a){a.doKeys("o");b.replaceRange("z",b.getCursor());a.doInsertModeKeys("Esc");b.setCursor(1,2);a.doKeys(".");eq("{\n  z\n  z",b.getValue());a.assertCursorAt(2,2)},{value:"{"});d("._insert_cw",function(b,c,a){a.doKeys("c",
"w");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");b.setCursor(0,3);a.doKeys("2","l");a.doKeys(".");eq("test test word3",b.getValue());a.assertCursorAt(0,8)},{value:"word1 word2 word3"});d("._insert_cw_repeat",function(b,c,a){a.doKeys("c","w");b.replaceRange("test",b.getCursor());a.doInsertModeKeys("Esc");b.setCursor(0,4);a.doKeys("l");a.doKeys("2",".");eq("test test",b.getValue());a.assertCursorAt(0,8)},{value:"word1 word2 word3"});d("._delete",function(b,c,a){b.setCursor(0,5);a.doKeys("i");
a.doInsertModeKeys("Backspace","Esc");a.doKeys(".");eq("zace",b.getValue());a.assertCursorAt(0,1)},{value:"zabcde"});d("._delete_repeat",function(b,c,a){b.setCursor(0,6);a.doKeys("i");a.doInsertModeKeys("Backspace","Esc");a.doKeys("2",".");eq("zzce",b.getValue());a.assertCursorAt(0,1)},{value:"zzabcde"});d("._visual_\x3e",function(b,c,a){b.setCursor(0,0);a.doKeys("V","j","\x3e");b.setCursor(2,0);a.doKeys(".");eq("  1\n  2\n  3\n  4",b.getValue());a.assertCursorAt(2,2)},{value:"1\n2\n3\n4"});d("f;",
function(b,c,a){b.setCursor(0,0);a.doKeys("f","x");a.doKeys(";");a.doKeys("2",";");eq(9,b.getCursor().ch)},{value:"01x3xx678x"});d("F;",function(b,c,a){b.setCursor(0,8);a.doKeys("F","x");a.doKeys(";");a.doKeys("2",";");eq(2,b.getCursor().ch)},{value:"01x3xx6x8x"});d("t;",function(b,c,a){b.setCursor(0,0);a.doKeys("t","x");a.doKeys(";");a.doKeys("2",";");eq(8,b.getCursor().ch)},{value:"01x3xx678x"});d("T;",function(b,c,a){b.setCursor(0,9);a.doKeys("T","x");a.doKeys(";");a.doKeys("2",";");eq(2,b.getCursor().ch)},
{value:"0xx3xx678x"});d("f,",function(b,c,a){b.setCursor(0,6);a.doKeys("f","x");a.doKeys(",");a.doKeys("2",",");eq(2,b.getCursor().ch)},{value:"01x3xx678x"});d("F,",function(b,c,a){b.setCursor(0,3);a.doKeys("F","x");a.doKeys(",");a.doKeys("2",",");eq(9,b.getCursor().ch)},{value:"01x3xx678x"});d("t,",function(b,c,a){b.setCursor(0,6);a.doKeys("t","x");a.doKeys(",");a.doKeys("2",",");eq(3,b.getCursor().ch)},{value:"01x3xx678x"});d("T,",function(b,c,a){b.setCursor(0,4);a.doKeys("T","x");a.doKeys(",");
a.doKeys("2",",");eq(8,b.getCursor().ch)},{value:"01x3xx67xx"});d("fd,;",function(b,c,a){b.setCursor(0,0);a.doKeys("f","4");b.setCursor(0,0);a.doKeys("d",";");eq("56789",b.getValue());a.doKeys("u");b.setCursor(0,9);a.doKeys("d",",");eq("01239",b.getValue())},{value:"0123456789"});d("Fd,;",function(b,c,a){b.setCursor(0,9);a.doKeys("F","4");b.setCursor(0,9);a.doKeys("d",";");eq("01239",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("d",",");eq("56789",b.getValue())},{value:"0123456789"});d("td,;",
function(b,c,a){b.setCursor(0,0);a.doKeys("t","4");b.setCursor(0,0);a.doKeys("d",";");eq("456789",b.getValue());a.doKeys("u");b.setCursor(0,9);a.doKeys("d",",");eq("012349",b.getValue())},{value:"0123456789"});d("Td,;",function(b,c,a){b.setCursor(0,9);a.doKeys("T","4");b.setCursor(0,9);a.doKeys("d",";");eq("012349",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("d",",");eq("456789",b.getValue())},{value:"0123456789"});d("fc,;",function(b,c,a){b.setCursor(0,0);a.doKeys("f","4");b.setCursor(0,
0);a.doKeys("c",";","Esc");eq("56789",b.getValue());a.doKeys("u");b.setCursor(0,9);a.doKeys("c",",");eq("01239",b.getValue())},{value:"0123456789"});d("Fc,;",function(b,c,a){b.setCursor(0,9);a.doKeys("F","4");b.setCursor(0,9);a.doKeys("c",";","Esc");eq("01239",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("c",",");eq("56789",b.getValue())},{value:"0123456789"});d("tc,;",function(b,c,a){b.setCursor(0,0);a.doKeys("t","4");b.setCursor(0,0);a.doKeys("c",";","Esc");eq("456789",b.getValue());a.doKeys("u");
b.setCursor(0,9);a.doKeys("c",",");eq("012349",b.getValue())},{value:"0123456789"});d("Tc,;",function(b,c,a){b.setCursor(0,9);a.doKeys("T","4");b.setCursor(0,9);a.doKeys("c",";","Esc");eq("012349",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("c",",");eq("456789",b.getValue())},{value:"0123456789"});d("fy,;",function(b,c,a){b.setCursor(0,0);a.doKeys("f","4");b.setCursor(0,0);a.doKeys("y",";","P");eq("012340123456789",b.getValue());a.doKeys("u");b.setCursor(0,9);a.doKeys("y",",","P");eq("012345678456789",
b.getValue())},{value:"0123456789"});d("Fy,;",function(b,c,a){b.setCursor(0,9);a.doKeys("F","4");b.setCursor(0,9);a.doKeys("y",";","p");eq("012345678945678",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("y",",","P");eq("012340123456789",b.getValue())},{value:"0123456789"});d("ty,;",function(b,c,a){b.setCursor(0,0);a.doKeys("t","4");b.setCursor(0,0);a.doKeys("y",";","P");eq("01230123456789",b.getValue());a.doKeys("u");b.setCursor(0,9);a.doKeys("y",",","p");eq("01234567895678",b.getValue())},
{value:"0123456789"});d("Ty,;",function(b,c,a){b.setCursor(0,9);a.doKeys("T","4");b.setCursor(0,9);a.doKeys("y",";","p");eq("01234567895678",b.getValue());a.doKeys("u");b.setCursor(0,0);a.doKeys("y",",","P");eq("01230123456789",b.getValue())},{value:"0123456789"});d("HML",function(b,c,a){c=b.defaultTextHeight();b.setSize(600,35*c);b.setCursor(120,0);a.doKeys("H");a.assertCursorAt(86,2);a.doKeys("L");a.assertCursorAt(120,4);a.doKeys("M");a.assertCursorAt(103,4)},{value:function(){var b=Array(100),
c,a="    xx\n";c=b.join("  xx\n");a=b.join(a);return c+a}()});var r=[];D("zb zz zt z- z. z\x3cCR\x3e".split(" "),function(b,c){d(b,function(a,d,e){d=b[0];var f=b.substring(1),g=a.defaultTextHeight();a.setSize(600,35*g);a.setCursor(250,0);e.doKeys(d,f);r[c]=a.getScrollInfo().top},{value:Array(500).join("\n")})});d("zb\x3czz",function(b,c,a){eq(r[0]<r[1],!0)});d("zz\x3czt",function(b,c,a){eq(r[1]<r[2],!0)});d("zb\x3d\x3dz-",function(b,c,a){eq(r[0],r[3])});d("zz\x3d\x3dz.",function(b,c,a){eq(r[1],r[4])});
d("zt\x3d\x3dz\x3cCR\x3e",function(b,c,a){eq(r[2],r[5])});"jumped over the lazy dog.";d("moveTillCharacter",function(b,c,a){b.setCursor(0,0);b.openDialog=a.fakeOpenDialog("q");a.doKeys("/");eq(4,b.getCursor().ch);a.doKeys("t");a.doKeys("o");eq("The quick brown fox \n",b.getValue());a.doKeys("d");a.doKeys("t");a.doKeys("o");eq("The quick bown fox \n",b.getValue());a.doKeys(".");eq("The quick box \n",b.getValue());a.doKeys("d");a.doKeys("t");a.doKeys("q");eq("The quick box \n",b.getValue());a.doKeys("d");
a.doKeys("t");a.doKeys("z");eq("The quick box \n",b.getValue());a.doKeys("d");a.doKeys("N");eq("The ox \n",b.getValue());eq(4,b.getCursor().ch)},{value:"The quick brown fox \n"});d("searchForPipe",function(b,c,a){CodeMirror.Vim.setOption("pcre",!1);b.setCursor(0,0);b.openDialog=a.fakeOpenDialog("|");a.doKeys("/");eq(4,b.getCursor().ch)},{value:"this|that"});"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";
d("scrollMotion",function(b,c,a){var d;b.setCursor(0,0);a.doKeys("\x3cC-y\x3e");eq(0,b.getCursor().line);d=b.getScrollInfo();a.doKeys("\x3cC-e\x3e");eq(1,b.getCursor().line);is(d.top<b.getScrollInfo().top);b.setCursor(1E3,0);c=b.getCursor();a.doKeys("\x3cC-e\x3e");eq(c.line,b.getCursor().line);d=b.getScrollInfo();a.doKeys("\x3cC-y\x3e");eq(c.line-1,b.getCursor().line);is(d.top>b.getScrollInfo().top)},{value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"});d("[[, ]]",function(b,c,a){b.setCursor(0,
0);a.doKeys("]","]");a.assertCursorAt(9,0);a.doKeys("2","]","]");a.assertCursorAt(13,0);a.doKeys("]","]");a.assertCursorAt(17,0);a.doKeys("[","[");a.assertCursorAt(13,0);a.doKeys("2","[","[");a.assertCursorAt(9,0);a.doKeys("[","[");a.assertCursorAt(0,0)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("[], ][",function(b,c,a){b.setCursor(0,0);a.doKeys("]","[");a.assertCursorAt(12,0);a.doKeys("2",
"]","[");a.assertCursorAt(16,0);a.doKeys("]","[");a.assertCursorAt(17,0);a.doKeys("[","]");a.assertCursorAt(16,0);a.doKeys("2","[","]");a.assertCursorAt(12,0);a.doKeys("[","]");a.assertCursorAt(0,0)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("[{, ]}",function(b,c,a){b.setCursor(4,10);a.doKeys("[","{");a.assertCursorAt(2,12);a.doKeys("2","[","{");a.assertCursorAt(0,1);b.setCursor(4,
10);a.doKeys("]","}");a.assertCursorAt(6,11);a.doKeys("2","]","}");a.assertCursorAt(8,1);b.setCursor(0,1);a.doKeys("]","}");a.assertCursorAt(8,1);a.doKeys("[","{");a.assertCursorAt(0,1)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("[(, ])",function(b,c,a){b.setCursor(4,10);a.doKeys("[","(");a.assertCursorAt(3,14);a.doKeys("2","[","(");a.assertCursorAt(0,0);b.setCursor(4,10);a.doKeys("]",
")");a.assertCursorAt(5,11);a.doKeys("2","]",")");a.assertCursorAt(8,0);a.doKeys("[","(");a.assertCursorAt(0,0);a.doKeys("]",")");a.assertCursorAt(8,0)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("[*, ]*, [/, ]/",function(b,c,a){D(["*","/"],function(c){b.setCursor(7,0);a.doKeys("2","[",c);a.assertCursorAt(2,2);a.doKeys("2","]",c);a.assertCursorAt(7,5)})},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});
d("[#, ]#",function(b,c,a){b.setCursor(10,3);a.doKeys("2","[","#");a.assertCursorAt(4,0);a.doKeys("5","]","#");a.assertCursorAt(17,0);b.setCursor(10,3);a.doKeys("]","#");a.assertCursorAt(14,0)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("[m, ]m, [M, ]M",function(b,c,a){b.setCursor(11,0);a.doKeys("[","m");a.assertCursorAt(10,7);a.doKeys("4","[","m");a.assertCursorAt(1,3);a.doKeys("5",
"]","m");a.assertCursorAt(11,0);a.doKeys("[","M");a.assertCursorAt(9,1);a.doKeys("3","]","M");a.assertCursorAt(15,0);a.doKeys("5","[","M");a.assertCursorAt(7,3)},{value:"({\n  ({\n  /*comment {\n            */(\n#else                \n  /*       )\n#if        }\n  )}*/\n)}\n{}\n#else {{\n{}\n}\n{\n#endif\n}\n}\n#else"});d("ex_go_to_line",function(b,c,a){b.setCursor(0,0);a.doEx("4");a.assertCursorAt(3,0)},{value:"a\nb\nc\nd\ne\n"});d("ex_write",function(b,c,a){c=CodeMirror.commands.save;var d,e;CodeMirror.commands.save=
function(a){d=!0;e=a};for(var f=1;5>f;f++)d=!1,e=null,a.doEx("write".substring(0,f)),eq(d,!0),eq(e,b);CodeMirror.commands.save=c});d("ex_sort",function(b,c,a){a.doEx("sort");eq("Z\na\nb\nc\nd",b.getValue())},{value:"b\nZ\nd\nc\na"});d("ex_sort_reverse",function(b,c,a){a.doEx("sort!");eq("d\nc\nb\na",b.getValue())},{value:"b\nd\nc\na"});d("ex_sort_range",function(b,c,a){a.doEx("2,3sort");eq("b\nc\nd\na",b.getValue())},{value:"b\nd\nc\na"});d("ex_sort_oneline",function(b,c,a){a.doEx("2sort");eq("b\nd\nc\na",
b.getValue())},{value:"b\nd\nc\na"});d("ex_sort_ignoreCase",function(b,c,a){a.doEx("sort i");eq("a\nb\nc\nd\nZ",b.getValue())},{value:"b\nZ\nd\nc\na"});d("ex_sort_unique",function(b,c,a){a.doEx("sort u");eq("Z\na\nb\nc\nd",b.getValue())},{value:"b\nZ\na\na\nd\na\nc\na"});d("ex_sort_decimal",function(b,c,a){a.doEx("sort d");eq("d3\n s5\n6\n.9",b.getValue())},{value:"6\nd3\n s5\n.9"});d("ex_sort_decimal_negative",function(b,c,a){a.doEx("sort d");eq("z-9\nd3\n s5\n6\n.9",b.getValue())},{value:"6\nd3\n s5\n.9\nz-9"});
d("ex_sort_decimal_reverse",function(b,c,a){a.doEx("sort! d");eq(".9\n6\n s5\nd3",b.getValue())},{value:"6\nd3\n s5\n.9"});d("ex_sort_hex",function(b,c,a){a.doEx("sort x");eq(" s5\n6\n.9\n\x260xB\nd3",b.getValue())},{value:"6\nd3\n s5\n\x260xB\n.9"});d("ex_sort_octal",function(b,c,a){a.doEx("sort o");eq(".8\n.9\nd3\n s5\n6",b.getValue())},{value:"6\nd3\n s5\n.9\n.8"});d("ex_sort_decimal_mixed",function(b,c,a){a.doEx("sort d");eq("y\nz\nc1\nb2\na3",b.getValue())},{value:"a3\nz\nc1\ny\nb2"});d("ex_sort_decimal_mixed_reverse",
function(b,c,a){a.doEx("sort! d");eq("a3\nb2\nc1\nz\ny",b.getValue())},{value:"a3\nz\nc1\ny\nb2"});d("ex_substitute_same_line",function(b,c,a){b.setCursor(1,0);a.doEx("s/one/two");eq("one one\n two two",b.getValue())},{value:"one one\n one one"});d("ex_substitute_global",function(b,c,a){b.setCursor(1,0);a.doEx("%s/one/two");eq("two two\n two two",b.getValue())},{value:"one one\n one one"});d("ex_substitute_input_range",function(b,c,a){b.setCursor(1,0);a.doEx("1,3s/\\d/0");eq("0\n0\n0\n4",b.getValue())},
{value:"1\n2\n3\n4"});d("ex_substitute_visual_range",function(b,c,a){b.setCursor(1,0);a.doKeys("V","2","j","v");a.doEx("'\x3c,'\x3es/\\d/0");eq("1\n0\n0\n0\n5",b.getValue())},{value:"1\n2\n3\n4\n5"});d("ex_substitute_empty_query",function(b,c,a){b.setCursor(1,0);b.openDialog=a.fakeOpenDialog("1");a.doKeys("/");a.doEx("s//b");eq("abb ab2 ab3",b.getValue())},{value:"a11 a12 a13"});d("ex_substitute_javascript",function(b,c,a){CodeMirror.Vim.setOption("pcre",!1);b.setCursor(1,0);a.doEx("s/\\(\\d+\\)/$$ $' $` $\x26 \\1/");
eq("a $$ $' $` $\x26 0 b",b.getValue())},{value:"a 0 b"});d("ex_substitute_empty_arguments",function(b,c,a){b.setCursor(0,0);a.doEx("s/a/b");b.setCursor(1,0);a.doEx("s");eq("b b\nb b",b.getValue())},{value:"a a\na a"});l("ex_substitute_capture",{value:"a11 a12 a13",expectedValue:"a1111 a1212 a1313",expr:"s/(\\d+)/$1$1/",noPcreExpr:"s/\\(\\d+\\)/\\1\\1/"});l("ex_substitute_capture2",{value:"a 0 b",expectedValue:"a $00 b",expr:"s/(\\d+)/$$$1$1/",noPcreExpr:"s/\\(\\d+\\)/$\\1\\1/"});l("ex_substitute_nocapture",
{value:"a11 a12 a13",expectedValue:"a$1$1 a$1$1 a$1$1",expr:"s/(\\d+)/$$1$$1",noPcreExpr:"s/\\(\\d+\\)/$1$1/"});l("ex_substitute_nocapture2",{value:"a 0 b",expectedValue:"a $10 b",expr:"s/(\\d+)/$$1$1",noPcreExpr:"s/\\(\\d+\\)/\\$1\\1/"});l("ex_substitute_nocapture",{value:"a b c",expectedValue:"a $ c",expr:"s/b/$$/",noPcreExpr:"s/b/$/"});l("ex_substitute_slash_regex",{value:"one/two \n three/four",expectedValue:"one|two \n three|four",expr:"%s/\\//|"});l("ex_substitute_pipe_regex",{value:"one|two \n three|four",
expectedValue:"one,two \n three,four",expr:"%s/\\|/,/",noPcreExpr:"%s/|/,/"});l("ex_substitute_or_regex",{value:"one|two \n three|four",expectedValue:"ana|twa \n thraa|faar",expr:"%s/o|e|u/a",noPcreExpr:"%s/o\\|e\\|u/a"});l("ex_substitute_or_word_regex",{value:"one|two \n three|four",expectedValue:"five|five \n three|four",expr:"%s/(one|two)/five/",noPcreExpr:"%s/\\(one\\|two\\)/five"});l("ex_substitute_backslashslash_regex",{value:"one\\two \n three\\four",expectedValue:"one,two \n three,four",expr:"%s/\\\\/,"});
l("ex_substitute_slash_replacement",{value:"one,two \n three,four",expectedValue:"one/two \n three/four",expr:"%s/,/\\/"});l("ex_substitute_backslash_replacement",{value:"one,two \n three,four",expectedValue:"one\\two \n three\\four",expr:"%s/,/\\\\/g"});l("ex_substitute_multibackslash_replacement",{value:"one,two \n three,four",expectedValue:"one\\\\\\\\two \n three\\\\\\\\four",expr:"%s/,/\\\\\\\\\\\\\\\\/g"});l("ex_substitute_braces_word",{value:"ababab abb ab{2}",expectedValue:"ab abb ab{2}",
expr:"%s/(ab){2}//g",noPcreExpr:"%s/\\(ab\\)\\{2\\}//g"});l("ex_substitute_braces_range",{value:"a aa aaa aaaa",expectedValue:"a   a",expr:"%s/a{2,3}//g",noPcreExpr:"%s/a\\{2,3\\}//g"});l("ex_substitute_braces_literal",{value:"ababab abb ab{2}",expectedValue:"ababab abb ",expr:"%s/ab\\{2\\}//g",noPcreExpr:"%s/ab{2}//g"});l("ex_substitute_braces_char",{value:"ababab abb ab{2}",expectedValue:"ababab  ab{2}",expr:"%s/ab{2}//g",noPcreExpr:"%s/ab\\{2\\}//g"});l("ex_substitute_braces_no_escape",{value:"ababab abb ab{2}",
expectedValue:"ababab  ab{2}",expr:"%s/ab{2}//g",noPcreExpr:"%s/ab\\{2}//g"});l("ex_substitute_count",{value:"1\n2\n3\n4",expectedValue:"1\n0\n0\n4",expr:"s/\\d/0/i 2"});l("ex_substitute_count_with_range",{value:"1\n2\n3\n4",expectedValue:"1\n2\n0\n0",expr:"1,3s/\\d/0/ 3"});q("ex_substitute_confirm_emptydoc","%s/x/b/c","","","",e(0,0));q("ex_substitute_confirm_nomatch","%s/x/b/c","ba a\nbab","ba a\nbab","",e(0,0));q("ex_substitute_confirm_accept","%s/a/b/c","ba a\nbab","bb b\nbbb","yyy",e(1,1));q("ex_substitute_confirm_random_keys",
"%s/a/b/c","ba a\nbab","bb b\nbbb","ysdkywerty",e(1,1));q("ex_substitute_confirm_some","%s/a/b/c","ba a\nbab","bb a\nbbb","yny",e(1,1));q("ex_substitute_confirm_all","%s/a/b/c","ba a\nbab","bb b\nbbb","a",e(1,1));q("ex_substitute_confirm_accept_then_all","%s/a/b/c","ba a\nbab","bb b\nbbb","ya",e(1,1));q("ex_substitute_confirm_quit","%s/a/b/c","ba a\nbab","bb a\nbab","yq",e(0,3));q("ex_substitute_confirm_last","%s/a/b/c","ba a\nbab","bb b\nbab","yl",e(0,3));q("ex_substitute_confirm_oneline","1s/a/b/c",
"ba a\nbab","bb b\nbab","yl",e(0,3));q("ex_substitute_confirm_range_accept","1,2s/a/b/c","aa\na \na\na","bb\nb \na\na","yyy",e(1,0));q("ex_substitute_confirm_range_some","1,3s/a/b/c","aa\na \na\na","ba\nb \nb\na","ynyy",e(2,0));q("ex_substitute_confirm_range_all","1,3s/a/b/c","aa\na \na\na","bb\nb \nb\na","a",e(2,0));q("ex_substitute_confirm_range_last","1,3s/a/b/c","aa\na \na\na","bb\nb \na\na","yyl",e(1,0));d("ex_noh_clearSearchHighlight",function(b,c,a){b.openDialog=a.fakeOpenDialog("match");a.doKeys("?");
a.doEx("noh");eq(c.searchState_.getOverlay(),null,"match-highlighting wasn't cleared");a.doKeys("n");a.assertCursorAt(0,11,"can't resume search after clearing highlighting")},{value:"match nope match \n nope Match"});d("set_boolean",function(b,c,a){CodeMirror.Vim.defineOption("testoption",!0,"boolean");is(CodeMirror.Vim.getOption("testoption"));try{CodeMirror.Vim.setOption("testoption","5"),fail()}catch(d){}CodeMirror.Vim.setOption("testoption",!1);is(!CodeMirror.Vim.getOption("testoption"))});d("ex_set_boolean",
function(b,c,a){CodeMirror.Vim.defineOption("testoption",!0,"boolean");is(CodeMirror.Vim.getOption("testoption"));try{a.doEx("set testoption\x3d22"),fail()}catch(d){}a.doEx("set notestoption");is(!CodeMirror.Vim.getOption("testoption"))});d("set_string",function(b,c,a){CodeMirror.Vim.defineOption("testoption","a","string");eq("a",CodeMirror.Vim.getOption("testoption"));try{CodeMirror.Vim.setOption("testoption",!0),fail()}catch(d){}try{CodeMirror.Vim.setOption("notestoption","b"),fail()}catch(e){}CodeMirror.Vim.setOption("testoption",
"c");eq("c",CodeMirror.Vim.getOption("testoption"))});d("ex_set_string",function(b,c,a){CodeMirror.Vim.defineOption("testoption","a","string");eq("a",CodeMirror.Vim.getOption("testoption"));try{a.doEx("set notestoption\x3db"),fail()}catch(d){}a.doEx("set testoption\x3dc");eq("c",CodeMirror.Vim.getOption("testoption"))});d("ex_map_key2key",function(b,c,a){a.doEx("map a x");a.doKeys("a");a.assertCursorAt(0,0);eq("bc",b.getValue())},{value:"abc"});d("ex_unmap_key2key",function(b,c,a){a.doEx("unmap a");
a.doKeys("a");eq("vim-insert",b.getOption("keyMap"))},{value:"abc"});d("ex_unmap_key2key_does_not_remove_default",function(b,c,a){try{a.doEx("unmap a"),fail()}catch(d){}a.doKeys("a");eq("vim-insert",b.getOption("keyMap"))},{value:"abc"});d("ex_map_key2key_to_colon",function(b,c,a){a.doEx("map ; :");var d=!1;b.openDialog=function(){d=!0};a.doKeys(";");eq(d,!0)});d("ex_map_ex2key:",function(b,c,a){a.doEx("map :del x");a.doEx("del");a.assertCursorAt(0,0);eq("bc",b.getValue())},{value:"abc"});d("ex_map_ex2ex",
function(b,c,a){a.doEx("map :del :w");c=CodeMirror.commands.save;var d=!1,e;CodeMirror.commands.save=function(a){d=!0;e=a};a.doEx("del");CodeMirror.commands.save=c;eq(d,!0);eq(e,b)});d("ex_map_key2ex",function(b,c,a){a.doEx("map a :w");c=CodeMirror.commands.save;var d=!1,e;CodeMirror.commands.save=function(a){d=!0;e=a};a.doKeys("a");CodeMirror.commands.save=c;eq(d,!0);eq(e,b)});d("ex_map_key2key_visual_api",function(b,c,a){CodeMirror.Vim.map("b",":w","visual");c=CodeMirror.commands.save;var d=!1,
e;CodeMirror.commands.save=function(a){d=!0;e=a};a.doKeys("b");eq(d,!1);a.doKeys("v","b");eq(d,!0);eq(e,b);CodeMirror.commands.save=c});d("ex_api_test",function(b,c,a){var d=!1,e="from";CodeMirror.Vim.defineEx("extest","ext",function(a,b){b.args?e=b.args[0]:d=!0});a.doEx(":ext to");eq(e,"to","Defining ex-command failed");CodeMirror.Vim.map("\x3cC-CR\x3e\x3cSpace\x3e",":ext");a.doKeys("\x3cC-CR\x3e","\x3cSpace\x3e");is(d,"Mapping to key failed")});d("ex_map_key2key_from_colon",function(b,c,a){a.doEx("map : x");
a.doKeys(":");a.assertCursorAt(0,0);eq("bc",b.getValue())},{value:"abc"});d("beforeSelectionChange",function(b,c,a){b.setCursor(0,100);eqPos(b.getCursor("head"),b.getCursor("anchor"))},{value:"abc"})});
//# sourceMappingURL=vim_test.js.map